<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="noodp" />
    <title class="pjax-title">Lua - Hmily云笔记</title><meta name="Description" content="一个简洁、优雅且高效的博客云笔记"><meta property="og:title" content="Lua" />
<meta property="og:description" content="lua基本语法 Lua 学习起来非常简单，我们可以创建第一个 Lua 程序！ 打印输出 1 print(&#34;Hello World&#34;) 单行注释 两个减号是单行注释: 1 -- 多行注释 两个减号是单行注释: 1 2 3" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://xinqinew.github.io/2022/01/lua%E5%9F%BA%E7%A1%80/" /><meta property="og:image" content="https://xinqinew.github.io/logo.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-01-07T00:00:00+00:00" />
<meta property="article:modified_time" content="2022-01-07T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://xinqinew.github.io/logo.png"/>

<meta name="twitter:title" content="Lua"/>
<meta name="twitter:description" content="lua基本语法 Lua 学习起来非常简单，我们可以创建第一个 Lua 程序！ 打印输出 1 print(&#34;Hello World&#34;) 单行注释 两个减号是单行注释: 1 -- 多行注释 两个减号是单行注释: 1 2 3"/>
<meta name="application-name" content="Hmily云笔记">
<meta name="apple-mobile-web-app-title" content="Hmily云笔记">

<meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://xinqinew.github.io/2022/01/lua%E5%9F%BA%E7%A1%80/" /><link rel="prev" href="https://xinqinew.github.io/2022/01/lua-mac%E7%BC%96%E8%AF%91%E5%92%8C%E5%AE%89%E8%A3%85/" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css">
    <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css"></noscript><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css">
    <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css"></noscript><meta name="google-site-verification" content="G-WYTDS8EES7" /><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Lua",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/xinqinew.github.io\/2022\/01\/lua%E5%9F%BA%E7%A1%80\/"
        },"image": ["https:\/\/xinqinew.github.io\/images\/Apple-Devices-Preview.png"],"genre": "posts","keywords": "Lua","wordcount":  13716 ,
        "url": "https:\/\/xinqinew.github.io\/2022\/01\/lua%E5%9F%BA%E7%A1%80\/","datePublished": "2022-01-07T00:00:00+00:00","dateModified": "2022-01-07T00:00:00+00:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "xxxx","logo": "https:\/\/xinqinew.github.io\/LoveIt-extend\/images\/avatar.png"},"author": {
                "@type": "Person",
                "name": "辛琪"
            },"description": ""
    }
    </script></head>

<body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">
        function setTheme(theme) {document.body.setAttribute('theme', theme);}
        function saveTheme(theme) {window.localStorage && localStorage.setItem('theme', theme);}
        function getMeta(metaName) {const metas = document.getElementsByTagName('meta'); for (let i = 0; i < metas.length; i++) if (metas[i].getAttribute('name') === metaName) return metas[i]; return '';}
        if (window.localStorage && localStorage.getItem('theme')) {let theme = localStorage.getItem('theme');theme === 'light' || theme === 'dark' || theme === 'black' ? setTheme(theme) : (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? setTheme('dark') : setTheme('light')); } else { if ('auto' === 'light' || 'auto' === 'dark' || 'auto' === 'black') setTheme('auto'), saveTheme('auto'); else saveTheme('auto'), window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? setTheme('dark') : setTheme('light');}
        let themeColorMeta = getMeta('theme-color');
        if (document.body.getAttribute('theme') != 'light') themeColorMeta.content = '#000000';
    </script>
    <div id="back-to-top"></div>
    <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Hmily云笔记"><span class="header-title-pre"><i class='fas fa-vihara'></i></span>Hmily云笔记</a>
        </div>
        <div class="menu" style="overflow: visible">
            <div class="menu-inner"><a class="menu-item" href="/posts/" title="所有文章"><i class='fas fa-archive fa-fw'></i>文档</a>
                    <a class="menu-item" href="/tags/"><i class='fas fa-tags fa-fw'></i> 标签</a>
                    <a class="menu-item" href="/categories/"><i class='fas fa-th-list fa-fw'></i>分类</a>
                    <a class="menu-item" href="/milestone/"><i class='fas fa-monument fa-fw'></i>里程碑</a>
                    <a class="menu-item" href="https://mermaid-js.github.io/mermaid-live-editor/" rel="noopener noreffer" target="_blank"><i class='fas fa-chess fa-fw'></i>mermaid</a>
                    <span class="menu-item delimiter"></span>
                   <a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Hmily云笔记"><span class="header-title-pre"><i class='fas fa-vihara'></i></span>Hmily云笔记</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="所有文章"><i class='fas fa-archive fa-fw'></i>文档</a>
            <a class="menu-item" href="/tags/" title=""><i class='fas fa-tags fa-fw'></i> 标签</a>
            <a class="menu-item" href="/categories/" title=""><i class='fas fa-th-list fa-fw'></i>分类</a>
            <a class="menu-item" href="/milestone/" title=""><i class='fas fa-monument fa-fw'></i>里程碑</a>
            <a class="menu-item" href="https://mermaid-js.github.io/mermaid-live-editor/" title="" rel="noopener noreffer" target="_blank"><i class='fas fa-chess fa-fw'></i>mermaid</a>
            
            <a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                <i class="fas fa-adjust fa-fw"></i>
            </a>
                </div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div><main class="main">
            <div class="container"><div class="toc" id="toc-auto">
        <h2 class="toc-title">目录</h2>
        <div class="toc-content" id="toc-content-auto"></div>
    </div><script>document.getElementsByTagName("main")[0].setAttribute("pageStyle", "normal")</script><script>document.getElementsByTagName("main")[0].setAttribute("autoTOC", "true")</script><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Lua</h1><div class="post-meta">
            <div class="post-meta-line">
                <span class="post-author"><i class="author fas fa-user-circle fa-fw"></i><a href="https://xinqinew.github.io" title="Author" target="_blank" rel="noopener noreffer author" class="author">辛琪</a>
                </span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2022-01-07">2022-01-07</time>&nbsp;<i class="far fa-edit fa-fw"></i>&nbsp;<time datetime="2022-01-07">2022-01-07</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 13716 字&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 28 分钟&nbsp;<span id="/2022/01/lua%E5%9F%BA%E7%A1%80/" class="leancloud_visitors" data-flag-title="Lua">
                        <i class="far fa-eye fa-fw"></i>&nbsp;<span class=leancloud-visitors-count></span>&nbsp;次阅读
                    </span>&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>目录</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#lua基本语法">lua基本语法</a>
          <ul>
            <li><a href="#打印输出">打印输出</a></li>
            <li><a href="#单行注释">单行注释</a></li>
            <li><a href="#多行注释">多行注释</a></li>
            <li><a href="#变量名称">变量名称</a></li>
            <li><a href="#全局变量">全局变量</a></li>
            <li><a href="#局部变量">局部变量</a></li>
          </ul>
        </li>
        <li><a href="#数据类型">数据类型</a>
          <ul>
            <li><a href="#nil-空">nil （空）</a></li>
            <li><a href="#boolean-布尔">boolean （布尔）</a></li>
            <li><a href="#number-数字">number （数字）</a></li>
            <li><a href="#string-字符串">string （字符串）</a></li>
            <li><a href="#table-表">table （表）</a></li>
            <li><a href="#function-函数">function (函数)</a></li>
            <li><a href="#thread-携程">thread （携程）</a></li>
            <li><a href="#userdata-自定义数据类型">userdata (自定义数据类型)</a></li>
          </ul>
        </li>
        <li><a href="#变量">变量</a>
          <ul>
            <li><a href="#赋值语句">赋值语句</a></li>
            <li><a href="#索引">索引</a></li>
          </ul>
        </li>
        <li><a href="#循环">循环</a>
          <ul>
            <li><a href="#while-循环">while 循环</a></li>
            <li><a href="#for-循环">for 循环</a></li>
          </ul>
        </li>
        <li><a href="#流程控制">流程控制</a>
          <ul>
            <li><a href="#if-语句">if 语句</a></li>
            <li><a href="#if-else-语句">if else 语句</a></li>
          </ul>
        </li>
        <li><a href="#函数">函数</a>
          <ul>
            <li><a href="#函数定义">函数定义</a></li>
            <li><a href="#可变参数">可变参数</a></li>
          </ul>
        </li>
        <li><a href="#运算符">运算符</a>
          <ul>
            <li><a href="#算术运算符">算术运算符</a></li>
            <li><a href="#关系运算符">关系运算符</a></li>
            <li><a href="#逻辑运算符">逻辑运算符</a></li>
            <li><a href="#其他运算符">其他运算符</a></li>
            <li><a href="#运算符优先级">运算符优先级</a></li>
          </ul>
        </li>
        <li><a href="#字符串">字符串</a>
          <ul>
            <li><a href="#转义字符">转义字符</a></li>
            <li><a href="#字符串操作">字符串操作</a></li>
            <li><a href="#字符串截取">字符串截取</a></li>
            <li><a href="#字符串格式化">字符串格式化</a></li>
            <li><a href="#字符与整数相互转换">字符与整数相互转换</a></li>
            <li><a href="#匹配模式">匹配模式</a>
              <ul>
                <li><a href="#模式">模式：</a></li>
                <li><a href="#捕获">捕获：</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#表-table">表 table</a>
          <ul>
            <li><a href="#table表的构造">table(表)的构造</a></li>
            <li><a href="#table-操作">table 操作</a>
              <ul>
                <li><a href="#table-连接">table 连接</a></li>
                <li><a href="#插入和移除">插入和移除</a></li>
                <li><a href="#table-排序">table 排序</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#迭代器">迭代器</a>
          <ul>
            <li><a href="#泛型-for-迭代器">泛型 for 迭代器</a></li>
          </ul>
        </li>
        <li><a href="#模块">模块</a>
          <ul>
            <li><a href="#加载路径">加载路径</a></li>
            <li><a href="#文件层级加载相关">文件层级加载相关</a></li>
            <li><a href="#多重加载">多重加载</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="lua基本语法">lua基本语法</h2>
<p>Lua 学习起来非常简单，我们可以创建第一个 Lua 程序！</p>
<h3 id="打印输出">打印输出</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl">    <span class="n">print</span><span class="p">(</span><span class="s2">&#34;Hello World&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="单行注释">单行注释</h3>
<p>两个减号是单行注释:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl">    <span class="c1">--</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="多行注释">多行注释</h3>
<p>两个减号是单行注释:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="cm">--[[
</span></span></span><span class="line"><span class="cl"><span class="cm"> 多行注释
</span></span></span><span class="line"><span class="cl"><span class="cm"> 多行注释
</span></span></span><span class="line"><span class="cl"><span class="cm"> --]]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="变量名称">变量名称</h3>
<p>Lua 标示符用于定义一个变量，函数获取其他用户定义的项。标示符以一个字母 A 到 Z 或 a 到 z 或下划线 _ 开头后加上 0 个或多个字母，下划线，数字（0 到 9）。</p>
<p>最好不要使用下划线加大写字母的标示符，因为Lua的保留字也是这样的。</p>
<p>Lua 不允许使用特殊字符如 @, $, 和 % 来定义标示符。 Lua 是一个区分大小写的编程语言。因此在 Lua 中 Nspirit 与 nspirit 是两个不同的标示符。以下列出了一些正确的变量名称：</p>
<table>
<thead>
<tr>
<th>案例</th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>mohd</td>
<td>zara</td>
<td>abc</td>
<td>move_name</td>
<td>a_123</td>
</tr>
<tr>
<td>myname50</td>
<td>_temp</td>
<td>j</td>
<td>a23b9</td>
<td>retVal</td>
</tr>
</tbody>
</table>
<hr>
<ul>
<li>关键词不可以被用来定义变量名称</li>
</ul>
<table>
<thead>
<tr>
<th>关键词</th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>and</td>
<td>break</td>
<td>do</td>
<td>else</td>
</tr>
<tr>
<td>elseif</td>
<td>end</td>
<td>false</td>
<td>for</td>
</tr>
<tr>
<td>function</td>
<td>if</td>
<td>in</td>
<td>local</td>
</tr>
<tr>
<td>nil</td>
<td>not</td>
<td>or</td>
<td>repeat</td>
</tr>
<tr>
<td>return</td>
<td>then</td>
<td>true</td>
<td>until</td>
</tr>
<tr>
<td>while</td>
<td>goto</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>一般约定，以下划线开头连接一串大写字母的名字（比如 _VERSION）被保留用于 Lua 内部全局变量。</p>
<h3 id="全局变量">全局变量</h3>
<p>在默认情况下，变量总是认为是全局的。</p>
<p>全局变量不需要声明，给一个变量赋值后即创建了这个全局变量，访问一个没有初始化的全局变量也不会出错，只不过得到的结果是：nil。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="c1">--&gt; nil</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span><span class="o">=</span><span class="mi">10</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="c1">--&gt; 10</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>如果你想删除一个全局变量，只需要将变量赋值为nil。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">b</span> <span class="o">=</span> <span class="kc">nil</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>      <span class="c1">--&gt; nil</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="局部变量">局部变量</h3>
<p>只需要在变量名称前 加一个 local，该全局变量就会变为局部变量</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl">  <span class="kd">local</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">10</span> <span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>局部变量值在作用域 范围内有效</p>
<ul>
<li>什么是域？ 比如当前lua文件，或者当前function 内,还是不懂请进入QQ群内，讨论咨询。</li>
</ul>
<h2 id="数据类型">数据类型</h2>
<p>Lua 是动态类型语言，变量不要类型定义,只需要为变量赋值。 值可以存储在变量中，作为参数传递或结果返回。</p>
<p>Lua 中有 8 个基本类型分别为：nil、boolean、number、string、userdata、function、thread 和 table。</p>
<table>
<thead>
<tr>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>nil</td>
<td>这个最简单，只有值nil属于该类，表示一个无效值（在条件表达式中相当于false）。</td>
</tr>
<tr>
<td>boolean</td>
<td>包含两个值：false和true。</td>
</tr>
<tr>
<td>number</td>
<td>表示双精度类型的实浮点数</td>
</tr>
<tr>
<td>function</td>
<td>由 C 或 Lua 编写的函数</td>
</tr>
<tr>
<td>userdata</td>
<td>表示任意存储在变量中的C数据结构</td>
</tr>
<tr>
<td>thread</td>
<td>表示执行的独立线路，用于执行协同程序</td>
</tr>
<tr>
<td>table</td>
<td>Lua 中的表（table）其实是一个&quot;关联数组&quot;（associative arrays），数组的索引可以是数字、字符串或表类型。在 Lua 里，table 的创建是通过&quot;构造表达式&quot;来完成，最简单构造表达式是{}，用来创建一个空表。</td>
</tr>
</tbody>
</table>
<ul>
<li>实例</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">type</span><span class="p">(</span><span class="s2">&#34;Hello world&#34;</span><span class="p">))</span>      <span class="c1">--&gt; string</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">type</span><span class="p">(</span><span class="mf">10.4</span><span class="o">*</span><span class="mi">3</span><span class="p">))</span>             <span class="c1">--&gt; number</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">type</span><span class="p">(</span><span class="n">print</span><span class="p">))</span>              <span class="c1">--&gt; function</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">type</span><span class="p">(</span><span class="n">type</span><span class="p">))</span>               <span class="c1">--&gt; function</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">type</span><span class="p">(</span><span class="kc">true</span><span class="p">))</span>               <span class="c1">--&gt; boolean</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">type</span><span class="p">(</span><span class="kc">nil</span><span class="p">))</span>                <span class="c1">--&gt; nil</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">type</span><span class="p">(</span><span class="n">type</span><span class="p">(</span><span class="n">X</span><span class="p">)))</span>            <span class="c1">--&gt; string</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="nil-空">nil （空）</h3>
<ul>
<li>nil 类型表示一种没有任何有效值，它只有一个值 &ndash; nil，例如打印一个没有赋值的变量，便会输出一个 nil 值：</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">type</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>                <span class="c1">--&gt; nil</span>
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<ul>
<li>对于全局变量和 table，nil 还有一个&quot;删除&quot;作用，给全局变量或者 table 表里的变量赋一个 nil 值，等同于把它们删掉，执行下面代码就知：</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">tab1</span> <span class="o">=</span> <span class="p">{</span> <span class="n">key1</span> <span class="o">=</span> <span class="s2">&#34;val1&#34;</span><span class="p">,</span> <span class="n">key2</span> <span class="o">=</span> <span class="s2">&#34;val2&#34;</span><span class="p">,</span> <span class="s2">&#34;val3&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kr">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="kr">in</span> <span class="n">pairs</span><span class="p">(</span><span class="n">tab1</span><span class="p">)</span> <span class="kr">do</span>
</span></span><span class="line"><span class="cl">    <span class="n">print</span><span class="p">(</span><span class="n">k</span> <span class="o">..</span> <span class="s2">&#34; - &#34;</span> <span class="o">..</span> <span class="n">v</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="n">tab1.key1</span> <span class="o">=</span> <span class="kc">nil</span>
</span></span><span class="line"><span class="cl"><span class="kr">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="kr">in</span> <span class="n">pairs</span><span class="p">(</span><span class="n">tab1</span><span class="p">)</span> <span class="kr">do</span>
</span></span><span class="line"><span class="cl">    <span class="n">print</span><span class="p">(</span><span class="n">k</span> <span class="o">..</span> <span class="s2">&#34; - &#34;</span> <span class="o">..</span> <span class="n">v</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<ul>
<li>nil 作比较时应该加上双引号 &ldquo;：</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">type</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="c1">--&gt; nil</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">type</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">==</span><span class="kc">nil</span> <span class="c1">--&gt; nil</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">type</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">==</span><span class="s2">&#34;nil&#34;</span> <span class="c1">--&gt; true</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="boolean-布尔">boolean （布尔）</h3>
<p>boolean 类型只有两个可选值：true（真） 和 false（假），Lua 把 false 和 nil 看作是 false，其他的都为 true，数字 0 也是 true:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">type</span><span class="p">(</span><span class="kc">true</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">type</span><span class="p">(</span><span class="kc">false</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">type</span><span class="p">(</span><span class="kc">nil</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="kr">if</span> <span class="kc">false</span> <span class="ow">or</span> <span class="kc">nil</span> <span class="kr">then</span>
</span></span><span class="line"><span class="cl">    <span class="n">print</span><span class="p">(</span><span class="s2">&#34;至少有一个是 true&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">else</span>
</span></span><span class="line"><span class="cl">    <span class="n">print</span><span class="p">(</span><span class="s2">&#34;false 和 nil 都为 false&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">if</span> <span class="mi">0</span> <span class="kr">then</span>
</span></span><span class="line"><span class="cl">    <span class="n">print</span><span class="p">(</span><span class="s2">&#34;数字 0 是 true&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">else</span>
</span></span><span class="line"><span class="cl">    <span class="n">print</span><span class="p">(</span><span class="s2">&#34;数字 0 为 false&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>以上代码执行结果</p>
</blockquote>
<p>boolean</p>
<p>boolean</p>
<p>nil</p>
<p>false 和 nil 都为 false</p>
<p>数字 0 是 true</p>
<hr>
<h3 id="number-数字">number （数字）</h3>
<p>Lua 默认只有一种 number 类型 &ndash; double（双精度）类型（默认类型可以修改 luaconf.h 里的定义），以下几种写法都被看作是 number 类型：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">type</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="c1">--&gt; number</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">type</span><span class="p">(</span><span class="mf">2.2</span><span class="p">))</span> <span class="c1">--&gt; number</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">type</span><span class="p">(</span><span class="mf">0.2</span><span class="p">))</span> <span class="c1">--&gt; number</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">type</span><span class="p">(</span><span class="mf">2e+1</span><span class="p">))</span> <span class="c1">--&gt; number</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">type</span><span class="p">(</span><span class="mf">0.2e-1</span><span class="p">))</span> <span class="c1">--&gt; number</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">type</span><span class="p">(</span><span class="mf">7.8263692594256e-06</span><span class="p">))</span> <span class="c1">--&gt; number</span>
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h3 id="string-字符串">string （字符串）</h3>
<ul>
<li>字符串由一对双引号或单引号来表示。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">string1</span> <span class="o">=</span> <span class="s2">&#34;this is string1&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">string2</span> <span class="o">=</span> <span class="s1">&#39;this is string2&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>也可以用 2 个方括号 &ldquo;[[]]&rdquo; 来表示&quot;一块&quot;字符串。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">html</span> <span class="o">=</span> <span class="s">[[
</span></span></span><span class="line"><span class="cl"><span class="s">&lt;html&gt;
</span></span></span><span class="line"><span class="cl"><span class="s">&lt;head&gt;&lt;/head&gt;
</span></span></span><span class="line"><span class="cl"><span class="s">&lt;body&gt;
</span></span></span><span class="line"><span class="cl"><span class="s">    &lt;a href=&#34;http://www.nspirit.cn/&#34;&gt;节点精灵&lt;/a&gt;
</span></span></span><span class="line"><span class="cl"><span class="s">&lt;/body&gt;
</span></span></span><span class="line"><span class="cl"><span class="s">&lt;/html&gt;
</span></span></span><span class="line"><span class="cl"><span class="s">]]</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>在对一个数字字符串上进行算术操作时，Lua 会尝试将这个数字字符串转成一个数字:</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;2&#34;</span> <span class="o">+</span> <span class="mi">6</span><span class="p">)</span> <span class="c1">--&gt;8.0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;2&#34;</span> <span class="o">+</span> <span class="s2">&#34;6&#34;</span><span class="p">)</span> <span class="c1">--&gt;8.0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;2 + 6&#34;</span><span class="p">)</span> <span class="c1">--&gt; 2 + 6</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;-2e2&#34;</span> <span class="o">*</span> <span class="s2">&#34;6&#34;</span><span class="p">)</span> <span class="c1">--&gt; -1200.0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;error&#34;</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">--&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- stdin:1: attempt to perform arithmetic on a string value</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- stack traceback:</span>
</span></span><span class="line"><span class="cl"><span class="c1">--        stdin:1: in main chunk</span>
</span></span><span class="line"><span class="cl"><span class="c1">--        [C]: in ?</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>以上代码中&quot;error&rdquo; + 1执行报错了，字符串连接使用的是 .. ，如：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;a&#34;</span> <span class="o">..</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span> <span class="c1">--&gt;ab</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="mi">157</span> <span class="o">..</span> <span class="mi">428</span><span class="p">)</span> <span class="c1">--&gt;157428</span>
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<ul>
<li>使用 # 来计算字符串的长度，放在字符串前面，如下实例：</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">len</span> <span class="o">=</span> <span class="s2">&#34;www.nspirit.cn&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="o">#</span><span class="n">len</span><span class="p">)</span> <span class="c1">--&gt; 14</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="o">#</span><span class="s2">&#34;www.nspirit.cn&#34;</span><span class="p">)</span> <span class="c1">--&gt;14</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="table-表">table （表）</h3>
<ul>
<li>在 Lua 里，table 的创建是通过&quot;构造表达式&quot;来完成，最简单构造表达式是{}，用来创建一个空表。也可以在表里添加一些数据，直接初始化表:</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="c1">-- 创建一个空的 table</span>
</span></span><span class="line"><span class="cl"><span class="kd">local</span> <span class="n">tbl1</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1">-- 直接初始表</span>
</span></span><span class="line"><span class="cl"><span class="kd">local</span> <span class="n">tbl2</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;apple&#34;</span><span class="p">,</span> <span class="s2">&#34;pear&#34;</span><span class="p">,</span> <span class="s2">&#34;orange&#34;</span><span class="p">,</span> <span class="s2">&#34;grape&#34;</span><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<ul>
<li>Lua 中的表（table）其实是一个&quot;关联数组&quot;（associative arrays），数组的索引可以是数字或者是字符串。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl"><span class="n">a</span><span class="p">[</span><span class="s2">&#34;key&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;value&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">key</span> <span class="o">=</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl"><span class="n">a</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="mi">22</span>
</span></span><span class="line"><span class="cl"><span class="n">a</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">+</span> <span class="mi">11</span>
</span></span><span class="line"><span class="cl"><span class="kr">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="kr">in</span> <span class="n">pairs</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="kr">do</span>
</span></span><span class="line"><span class="cl">    <span class="n">print</span><span class="p">(</span><span class="n">k</span> <span class="o">..</span> <span class="s2">&#34; : &#34;</span> <span class="o">..</span> <span class="n">v</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- 脚本执行结果为：</span>
</span></span><span class="line"><span class="cl"><span class="c1">--&gt; key : value</span>
</span></span><span class="line"><span class="cl"><span class="c1">--&gt; 10 : 33</span>
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<ul>
<li>不同于其他语言的数组把 0 作为数组的初始索引，在 Lua 里表的默认初始索引一般以 1 开始。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="c1">--实例</span>
</span></span><span class="line"><span class="cl"><span class="kd">local</span> <span class="n">tbl</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;apple&#34;</span><span class="p">,</span> <span class="s2">&#34;pear&#34;</span><span class="p">,</span> <span class="s2">&#34;orange&#34;</span><span class="p">,</span> <span class="s2">&#34;grape&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kr">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="kr">in</span> <span class="n">pairs</span><span class="p">(</span><span class="n">tbl</span><span class="p">)</span> <span class="kr">do</span>
</span></span><span class="line"><span class="cl">    <span class="n">print</span><span class="p">(</span><span class="s2">&#34;Key&#34;</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- 脚本执行结果为：</span>
</span></span><span class="line"><span class="cl"><span class="c1">--&gt; Key    1</span>
</span></span><span class="line"><span class="cl"><span class="c1">--&gt; Key    2</span>
</span></span><span class="line"><span class="cl"><span class="c1">--&gt; Key    3</span>
</span></span><span class="line"><span class="cl"><span class="c1">--&gt; Key    4</span>
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<ul>
<li>table 不会固定长度大小，有新数据添加时 table 长度会自动增长，没初始的 table 都是 nil。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">a3</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl"><span class="kr">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span> <span class="kr">do</span>
</span></span><span class="line"><span class="cl">    <span class="n">a3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span><span class="line"><span class="cl"><span class="n">a3</span><span class="p">[</span><span class="s2">&#34;key&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;val&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">a3</span><span class="p">[</span><span class="s2">&#34;key&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">a3</span><span class="p">[</span><span class="s2">&#34;none&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- 执行结果为：</span>
</span></span><span class="line"><span class="cl"><span class="c1">--&gt; val</span>
</span></span><span class="line"><span class="cl"><span class="c1">--&gt; nil</span>
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h3 id="function-函数">function (函数)</h3>
<p>在 Lua 中，函数是被看作是&quot;第一类值（First-Class Value）&quot;，函数可以存在变量里:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="kr">function</span> <span class="nf">factorial1</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="kr">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span> <span class="kr">then</span>
</span></span><span class="line"><span class="cl">        <span class="kr">return</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="kr">else</span>
</span></span><span class="line"><span class="cl">        <span class="kr">return</span> <span class="n">n</span> <span class="o">*</span> <span class="n">factorial1</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="kr">end</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">factorial1</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">factorial2</span> <span class="o">=</span> <span class="n">factorial1</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">factorial2</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- 输出结果为：</span>
</span></span><span class="line"><span class="cl"><span class="c1">--&gt; 120</span>
</span></span><span class="line"><span class="cl"><span class="c1">--&gt; 120</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>function 可以以匿名函数（anonymous function）的方式通过参数传递:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="kr">function</span> <span class="nf">testFun</span><span class="p">(</span><span class="n">tab</span><span class="p">,</span><span class="n">fun</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="kr">for</span> <span class="n">k</span> <span class="p">,</span><span class="n">v</span> <span class="kr">in</span> <span class="n">pairs</span><span class="p">(</span><span class="n">tab</span><span class="p">)</span> <span class="kr">do</span>
</span></span><span class="line"><span class="cl">                <span class="n">print</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="kr">end</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">tab</span><span class="o">=</span><span class="p">{</span><span class="n">key1</span><span class="o">=</span><span class="s2">&#34;val1&#34;</span><span class="p">,</span><span class="n">key2</span><span class="o">=</span><span class="s2">&#34;val2&#34;</span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="n">testFun</span><span class="p">(</span><span class="n">tab</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="kr">function</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="n">val</span><span class="p">)</span><span class="c1">--匿名函数</span>
</span></span><span class="line"><span class="cl">        <span class="kr">return</span> <span class="n">key</span><span class="o">..</span><span class="s2">&#34;=&#34;</span><span class="o">..</span><span class="n">val</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span><span class="line"><span class="cl"><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">--输出结果</span>
</span></span><span class="line"><span class="cl"><span class="c1">--&gt; key1 = val1</span>
</span></span><span class="line"><span class="cl"><span class="c1">--&gt; key2 = val2</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="thread-携程">thread （携程）</h3>
<p>在节点精灵中 不生效，已用java thread 做代替</p>
<h3 id="userdata-自定义数据类型">userdata (自定义数据类型)</h3>
<p>userdata 是一种用户自定义数据，用于表示一种由应用程序或 C/C++ 语言库所创建的类型，可以将任意 C/C++ 的任意数据类型的数据（通常是 struct 和 指针）存储到 Lua 变量中调用。</p>
<h2 id="变量">变量</h2>
<ul>
<li>变量在使用前，需要在代码中进行声明，即创建该变量。</li>
<li>编译程序执行代码之前编译器需要知道如何给语句变量开辟存储区，用于存储变量的值。</li>
<li>Lua 变量有三种类型：全局变量、局部变量、表中的域。</li>
<li>Lua 中的变量全是全局变量，哪怕是语句块或是函数里，除非用 local 显式声明为局部变量。</li>
<li>局部变量的作用域为从声明位置开始到所在语句块结束。</li>
<li>变量的默认值均为 nil。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="mi">5</span>               <span class="c1">-- 全局变量</span>
</span></span><span class="line"><span class="cl"><span class="kd">local</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">5</span>         <span class="c1">-- 局部变量</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">function</span> <span class="nf">joke</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">c</span> <span class="o">=</span> <span class="mi">5</span>           <span class="c1">-- 全局变量</span>
</span></span><span class="line"><span class="cl">    <span class="kd">local</span> <span class="n">d</span> <span class="o">=</span> <span class="mi">6</span>     <span class="c1">-- 局部变量</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">joke</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>          <span class="c1">--&gt; 5 </span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>          <span class="c1">--&gt; nil</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">do</span> 
</span></span><span class="line"><span class="cl">    <span class="kd">local</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">6</span>     <span class="c1">-- 局部变量</span>
</span></span><span class="line"><span class="cl">    <span class="n">b</span> <span class="o">=</span> <span class="mi">6</span>           <span class="c1">-- 对局部变量重新赋值</span>
</span></span><span class="line"><span class="cl">    <span class="n">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">);</span>     <span class="c1">--&gt; 6 6</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>      <span class="c1">--&gt; 5 6</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="赋值语句">赋值语句</h3>
<ul>
<li>赋值是改变一个变量的值和改变表域的最基本的方法。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="s2">&#34;hello&#34;</span> <span class="o">..</span> <span class="s2">&#34;world&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">t.n</span> <span class="o">=</span> <span class="n">t.n</span> <span class="o">+</span> <span class="mi">1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>Lua 可以对多个变量同时赋值，变量列表和值列表的各个元素用逗号分开，赋值语句右边的值会依次赋给左边的变量。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span>       <span class="c1">--&lt;&gt;       a=10; b=2*x</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>遇到赋值语句Lua会先计算右边所有的值然后再执行赋值操作，所以我们可以这样进行交换变量的值：</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl">  <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span>                     <span class="c1">-- swap &#39;x&#39; for &#39;y&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>         <span class="c1">-- swap &#39;a[i]&#39; for &#39;a[j]&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>当变量个数和值的个数不一致时，Lua会一直以变量个数为基础采取以下策略：</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="c1">-- a. 变量个数 &gt; 值的个数             按变量个数补足nil</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- b. 变量个数 &lt; 值的个数             多余的值会被忽略</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">)</span>             <span class="c1">--&gt; 0   1   nil</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">+</span><span class="mi">2</span>     <span class="c1">-- value of b+2 is ignored</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>               <span class="c1">--&gt; 1   2</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">)</span>             <span class="c1">--&gt; 0   nil   nil</span>
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<ul>
<li>多值赋值经常用来交换变量，或将函数调用返回给变量：</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">f</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1">--f()返回两个值，第一个赋给a，第二个赋给b。</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- 应该尽可能的使用局部变量，有两个好处：</span>
</span></span><span class="line"><span class="cl"><span class="c1">--  1.避免命名冲突。</span>
</span></span><span class="line"><span class="cl"><span class="c1">--  2.访问局部变量的速度比全局变量更快。</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="索引">索引</h3>
<p>对 table 的索引使用方括号 []。Lua 也提供了 . 操作。</p>
<ul>
<li>t[i]</li>
<li>t.i &ndash; 当索引为字符串类型时的一种简化写法</li>
<li>gettable_event(t,i) &ndash; 采用索引访问本质上是一个类似这样的函数调用</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">site</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl"><span class="n">site</span><span class="p">[</span><span class="s2">&#34;key&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;www.nspirit.cn&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">site</span><span class="p">[</span><span class="s2">&#34;key&#34;</span><span class="p">])</span> <span class="c1">--&gt; www.nspirit.cn</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">site.key</span><span class="p">)</span> <span class="c1">--&gt; www.nspirit.cn</span>
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="循环">循环</h2>
<p>很多情况下我们需要做一些有规律性的重复操作，因此在程序中就需要重复执行某些语句。</p>
<p>一组被重复执行的语句称之为循环体，能否继续重复，决定循环的终止条件。</p>
<p>循环结构是在一定条件下反复执行某段程序的流程结构，被反复执行的程序被称为循环体。</p>
<p>循环语句是由循环体及循环的终止条件两部分组成的。</p>
<h3 id="while-循环">while 循环</h3>
<p>Lua 编程语言中 while 循环语句在判断条件为 true 时会重复执行循环体语句。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">a</span><span class="o">=</span><span class="mi">10</span>
</span></span><span class="line"><span class="cl"><span class="kr">while</span><span class="p">(</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mi">20</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">do</span>
</span></span><span class="line"><span class="cl">   <span class="n">print</span><span class="p">(</span><span class="s2">&#34;a 的值为:&#34;</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">+</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="for-循环">for 循环</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="kr">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span> <span class="kr">do</span>
</span></span><span class="line"><span class="cl">    <span class="n">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">--打印数组a的所有值  </span>
</span></span><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;one&#34;</span><span class="p">,</span> <span class="s2">&#34;two&#34;</span><span class="p">,</span> <span class="s2">&#34;three&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kr">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="kr">in</span> <span class="n">ipairs</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="kr">do</span>
</span></span><span class="line"><span class="cl">    <span class="n">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span> 
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="流程控制">流程控制</h2>
<p>Lua 编程语言流程控制语句通过程序设定一个或多个条件语句来设定。在条件为 true 时执行指定程序代码，在条件为 false 时执行其他指定代码。</p>
<ul>
<li>控制结构的条件表达式结果可以是任何值，Lua认为false和nil为假，true和非nil为真。</li>
<li>要注意的是Lua中 0 为 true：</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="kr">if</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">then</span>
</span></span><span class="line"><span class="cl">    <span class="n">print</span><span class="p">(</span><span class="s2">&#34;0 为 true&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h3 id="if-语句">if 语句</h3>
<ul>
<li>Lua if 语句 由一个布尔表达式作为条件判断，其后紧跟其他语句组成。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="c1">--[ 定义变量 --]</span>
</span></span><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">--[ 使用 if 语句 --]</span>
</span></span><span class="line"><span class="cl"><span class="kr">if</span><span class="p">(</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mi">20</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">then</span>
</span></span><span class="line"><span class="cl">   <span class="c1">--[ if 条件为 true 时打印以下信息 --]</span>
</span></span><span class="line"><span class="cl">   <span class="n">print</span><span class="p">(</span><span class="s2">&#34;a 小于 20&#34;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;a 的值为:&#34;</span><span class="p">,</span> <span class="n">a</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="if-else-语句">if else 语句</h3>
<ul>
<li>以下实例用于判断变量 a 的值：</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">--[ 检查条件 --]</span>
</span></span><span class="line"><span class="cl"><span class="kr">if</span><span class="p">(</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mi">20</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">then</span>
</span></span><span class="line"><span class="cl">   <span class="c1">--[ if 条件为 true 时执行该语句块 --]</span>
</span></span><span class="line"><span class="cl">   <span class="n">print</span><span class="p">(</span><span class="s2">&#34;a 小于 20&#34;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">else</span>
</span></span><span class="line"><span class="cl">   <span class="c1">--[ if 条件为 false 时执行该语句块 --]</span>
</span></span><span class="line"><span class="cl">   <span class="n">print</span><span class="p">(</span><span class="s2">&#34;a 大于 20&#34;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;a 的值为 :&#34;</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>Lua if 语句可以与 elseif&hellip;else 语句搭配使用, 在 if 条件表达式为 false 时执行 elseif&hellip;else 语句代码块，用于检测多个条件语句。</li>
</ul>
<p>Lua if&hellip;elseif&hellip;else 语句语法格式如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="kr">if</span><span class="p">(</span> <span class="err">布尔表达式</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">then</span>
</span></span><span class="line"><span class="cl">   <span class="c1">--[ 在布尔表达式 1 为 true 时执行该语句块 --]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">elseif</span><span class="p">(</span> <span class="err">布尔表达式</span> <span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">then</span>
</span></span><span class="line"><span class="cl">   <span class="c1">--[ 在布尔表达式 2 为 true 时执行该语句块 --]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">elseif</span><span class="p">(</span> <span class="err">布尔表达式</span> <span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">then</span>
</span></span><span class="line"><span class="cl">   <span class="c1">--[ 在布尔表达式 3 为 true 时执行该语句块 --]</span>
</span></span><span class="line"><span class="cl"><span class="kr">else</span> 
</span></span><span class="line"><span class="cl">   <span class="c1">--[ 如果以上布尔表达式都不为 true 则执行该语句块 --]</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="函数">函数</h2>
<p>在Lua中，函数是对语句和表达式进行抽象的主要方法。既可以用来处理一些特殊的工作，也可以用来计算一些值。</p>
<p>Lua 提供了许多的内建函数，你可以很方便的在程序中调用它们，如print()函数可以将传入的参数打印在控制台上。</p>
<p>Lua 函数主要有两种用途：</p>
<ul>
<li>1.完成指定的任务，这种情况下函数作为调用语句使用；</li>
<li>2.计算并返回值，这种情况下函数作为赋值语句的表达式使用。</li>
</ul>
<h3 id="函数定义">函数定义</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">optional_function_scope</span> <span class="kr">function</span> <span class="nf">function_name</span><span class="p">(</span> <span class="n">argument1</span><span class="p">,</span> <span class="n">argument2</span><span class="p">,</span> <span class="n">argument3</span><span class="p">...,</span> <span class="n">argumentn</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">function_body</span>
</span></span><span class="line"><span class="cl">    <span class="kr">return</span> <span class="n">result_params_comma_separated</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>optional_function_scope: 该参数是可选的制定函数是全局函数还是局部函数，未设置该参数默认为全局函数，如果你需要设置函数为局部函数需要使用关键字 local。</li>
<li>function_name: 指定函数名称。</li>
<li>argument1, argument2, argument3&hellip;, argumentn: 函数参数，多个参数以逗号隔开，函数也可以不带参数。</li>
<li>function_body: 函数体，函数中需要执行的代码语句块。</li>
<li>result_params_comma_separated: 函数返回值，Lua语言函数可以返回多个值，每个值以逗号隔开。</li>
</ul>
<hr>
<p>以下实例定义了函数 max()，参数为 num1, num2，用于比较两值的大小，并返回最大值：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="kr">function</span> <span class="nf">max</span><span class="p">(</span><span class="n">num1</span><span class="p">,</span> <span class="n">num2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="kr">if</span> <span class="p">(</span><span class="n">num1</span> <span class="o">&gt;</span> <span class="n">num2</span><span class="p">)</span> <span class="kr">then</span>
</span></span><span class="line"><span class="cl">      <span class="n">result</span> <span class="o">=</span> <span class="n">num1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="kr">else</span>
</span></span><span class="line"><span class="cl">      <span class="n">result</span> <span class="o">=</span> <span class="n">num2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="kr">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="kr">return</span> <span class="n">result</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- 调用函数</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;两值比较最大值为 &#34;</span><span class="o">..</span><span class="n">max</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span> <span class="c1">--&gt; 两值比较最大值为     10</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;两值比较最大值为 &#34;</span><span class="o">..</span><span class="n">max</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span> <span class="c1">--&gt; 两值比较最大值为     6</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>Lua 中我们可以将函数作为参数传递给函数，如下实例：</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">myprint</span> <span class="o">=</span> <span class="kr">function</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="n">print</span><span class="p">(</span><span class="s2">&#34;这是打印函数 -   ##&#34;</span><span class="o">..</span><span class="n">param</span><span class="o">..</span><span class="s2">&#34;##&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">function</span> <span class="nf">add</span><span class="p">(</span><span class="n">num1</span><span class="p">,</span><span class="n">num2</span><span class="p">,</span><span class="n">functionPrint</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="n">result</span> <span class="o">=</span> <span class="n">num1</span> <span class="o">+</span> <span class="n">num2</span>
</span></span><span class="line"><span class="cl">   <span class="c1">-- 调用传递的函数参数</span>
</span></span><span class="line"><span class="cl">   <span class="n">functionPrint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span><span class="line"><span class="cl"><span class="n">myprint</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- myprint 函数作为参数传递</span>
</span></span><span class="line"><span class="cl"><span class="n">add</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">myprint</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">--输出结果</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- 这是打印函数 -   ##    10    ##</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- 这是打印函数 -   ##    7    ##</span>
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<ul>
<li>Lua函数可以返回多个结果值，比如string.find，其返回匹配串&quot;开始和结束的下标&quot;（如果不存在匹配串返回nil）。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">s</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">string.find</span><span class="p">(</span><span class="s2">&#34;www.nspirit.cn&#34;</span><span class="p">,</span> <span class="s2">&#34;nspirit&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">s</span><span class="o">..</span><span class="s1">&#39;,&#39;</span><span class="o">..</span><span class="n">e</span><span class="p">);</span> <span class="c1">-- &gt; 5,11</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="可变参数">可变参数</h3>
<p>Lua 函数可以接受可变数目的参数，和 C 语言类似，在函数参数列表中使用三点 &hellip; 表示函数有可变的参数。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="kr">function</span> <span class="nf">average</span><span class="p">(...)</span>
</span></span><span class="line"><span class="cl">   <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">   <span class="kd">local</span> <span class="n">arg</span><span class="o">=</span><span class="p">{...}</span>    <span class="c1">--&gt; arg 为一个表，局部变量</span>
</span></span><span class="line"><span class="cl">   <span class="kr">for</span> <span class="n">i</span><span class="p">,</span><span class="n">v</span> <span class="kr">in</span> <span class="n">ipairs</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="kr">do</span>
</span></span><span class="line"><span class="cl">      <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">+</span> <span class="n">v</span>
</span></span><span class="line"><span class="cl">   <span class="kr">end</span>
</span></span><span class="line"><span class="cl">   <span class="n">print</span><span class="p">(</span><span class="s2">&#34;总共传入 &#34;</span> <span class="o">..</span> <span class="o">#</span><span class="n">arg</span> <span class="o">..</span> <span class="s2">&#34; 个数&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="kr">return</span> <span class="n">result</span><span class="o">/#</span><span class="n">arg</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;平均值为&#34;</span><span class="p">,</span><span class="n">average</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">-- 以上代码执行结果为：</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- 总共传入 6 个数</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- 平均值为    5.5</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>我们也可以通过 select(&quot;#&quot;,&hellip;) 来获取可变参数的数量:</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="kr">function</span> <span class="nf">average</span><span class="p">(...)</span>
</span></span><span class="line"><span class="cl">   <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">   <span class="kd">local</span> <span class="n">arg</span><span class="o">=</span><span class="p">{...}</span>
</span></span><span class="line"><span class="cl">   <span class="kr">for</span> <span class="n">i</span><span class="p">,</span><span class="n">v</span> <span class="kr">in</span> <span class="n">ipairs</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="kr">do</span>
</span></span><span class="line"><span class="cl">      <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">+</span> <span class="n">v</span>
</span></span><span class="line"><span class="cl">   <span class="kr">end</span>
</span></span><span class="line"><span class="cl">   <span class="n">print</span><span class="p">(</span><span class="s2">&#34;总共传入 &#34;</span> <span class="o">..</span> <span class="n">select</span><span class="p">(</span><span class="s2">&#34;#&#34;</span><span class="p">,...)</span> <span class="o">..</span> <span class="s2">&#34; 个数&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="kr">return</span> <span class="n">result</span><span class="o">/</span><span class="n">select</span><span class="p">(</span><span class="s2">&#34;#&#34;</span><span class="p">,...)</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;平均值为&#34;</span><span class="o">..</span><span class="n">average</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>有时候我们可能需要几个固定参数加上可变参数，固定参数必须放在变长参数之前:</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="kr">function</span> <span class="nf">fwrite</span><span class="p">(</span><span class="n">fmt</span><span class="p">,</span> <span class="p">...)</span>  <span class="c1">---&gt; 固定的参数fmt</span>
</span></span><span class="line"><span class="cl">    <span class="kr">return</span> <span class="n">print</span><span class="p">(</span><span class="n">string.format</span><span class="p">(</span><span class="n">fmt</span><span class="p">,</span> <span class="p">...))</span>     
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">fwrite</span><span class="p">(</span><span class="s2">&#34;nspirit</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>       <span class="c1">---&gt;fmt = &#34;nspirit&#34;, 没有变长参数。  </span>
</span></span><span class="line"><span class="cl"><span class="n">fwrite</span><span class="p">(</span><span class="s2">&#34;%d%d</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>   <span class="c1">---&gt;fmt = &#34;%d%d&#34;, 变长参数为 1 和 2</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>通常在遍历变长参数的时候只需要使用 {…}，然而变长参数可能会包含一些 nil，那么就可以用 select 函数来访问变长参数了：select(&rsquo;#&rsquo;, …) 或者 select(n, …)</li>
</ul>
<p>select(&rsquo;#&rsquo;, …) 返回可变参数的长度。</p>
<p>select(n, …) 用于返回从起点 n 开始到结束位置的所有参数列表。</p>
<p>调用 select 时，必须传入一个固定实参 selector(选择开关) 和一系列变长参数。如果 selector 为数字 n，那么 select 返回参数列表中从索引 n 开始到 结束位置的所有参数列表，否则只能为字符串 #，这样 select 返回变长参数的总数。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="kr">function</span> <span class="nf">f</span><span class="p">(...)</span>
</span></span><span class="line"><span class="cl">    <span class="n">a</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span><span class="mi">3</span><span class="p">,...)</span>  <span class="c1">--&gt;从第三个位置开始，变量 a 对应右边变量列表的第一个参数</span>
</span></span><span class="line"><span class="cl">    <span class="n">print</span> <span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">f</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="c1">-- 输出结果</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- 2</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="kr">do</span>
</span></span><span class="line"><span class="cl"><span class="kr">function</span> <span class="nf">foo</span><span class="p">(...)</span>
</span></span><span class="line"><span class="cl">    <span class="kr">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">select</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">,</span> <span class="p">...)</span> <span class="kr">do</span> <span class="c1">--&gt;获取参数总数</span>
</span></span><span class="line"><span class="cl">        <span class="kd">local</span> <span class="n">arg</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="p">...);</span> <span class="c1">--&gt;读取参数，arg 对应的是右边变量列表的第一个参数</span>
</span></span><span class="line"><span class="cl">        <span class="n">print</span><span class="p">(</span><span class="s2">&#34;arg:&#34;</span><span class="o">..</span> <span class="n">arg</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kr">end</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">foo</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- 输出结果</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- 1</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- 2</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- 3</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- 4</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="运算符">运算符</h2>
<p>运算符是一个特殊的符号，用于告诉解释器执行特定的数学或逻辑运算。Lua提供了以下几种运算符类型：</p>
<ul>
<li>算术运算符</li>
<li>关系运算符</li>
<li>逻辑运算符</li>
<li>其他运算符</li>
</ul>
<h3 id="算术运算符">算术运算符</h3>
<table>
<thead>
<tr>
<th>操作符</th>
<th>描述</th>
<th>实例</th>
</tr>
</thead>
<tbody>
<tr>
<td>+</td>
<td>加法</td>
<td>A + B 输出结果 30</td>
</tr>
<tr>
<td>-</td>
<td>减法</td>
<td>A - B 输出结果 -10</td>
</tr>
<tr>
<td>*</td>
<td>乘法</td>
<td>A * B 输出结果 200</td>
</tr>
<tr>
<td>/</td>
<td>除法</td>
<td>B / A 输出结果 2</td>
</tr>
<tr>
<td>%</td>
<td>取余</td>
<td>B % A 输出结果 0</td>
</tr>
<tr>
<td>^</td>
<td>乘幂</td>
<td>A^2 输出结果 100</td>
</tr>
<tr>
<td>-</td>
<td>负号</td>
<td>-A 输出结果 -10</td>
</tr>
</tbody>
</table>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="mi">21</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span> <span class="o">=</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;Line 1 - c 的值为 &#34;</span><span class="o">..</span> <span class="n">c</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;Line 2 - c 的值为 &#34;</span><span class="o">..</span> <span class="n">c</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;Line 3 - c 的值为 &#34;</span><span class="o">..</span> <span class="n">c</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;Line 4 - c 的值为 &#34;</span><span class="o">..</span> <span class="n">c</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="n">a</span> <span class="o">%</span> <span class="n">b</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;Line 5 - c 的值为 &#34;</span><span class="o">..</span> <span class="n">c</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="n">a</span><span class="o">^</span><span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;Line 6 - c 的值为 &#34;</span><span class="o">..</span> <span class="n">c</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="o">-</span><span class="n">a</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;Line 7 - c 的值为 &#34;</span><span class="o">..</span> <span class="n">c</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">--输出结果为</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- Line 1 - c 的值为 31</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- Line 2 - c 的值为 11</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- Line 3 - c 的值为 210</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- Line 4 - c 的值为 2.1</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- Line 5 - c 的值为 1</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- Line 6 - c 的值为 441.0</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- Line 7 - c 的值为 -21</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="关系运算符">关系运算符</h3>
<ul>
<li>下表列出了 Lua 语言中的常用关系运算符，设定 A 的值为10，B 的值为 20：</li>
</ul>
<table>
<thead>
<tr>
<th>操作符</th>
<th>描述</th>
<th>实例</th>
</tr>
</thead>
<tbody>
<tr>
<td>==</td>
<td>等于，检测两个值是否相等，相等返回 true，否则返回 false</td>
<td>(A == B) 为 false。</td>
</tr>
<tr>
<td>~=</td>
<td>不等于，检测两个值是否相等，不相等返回 true，否则返回 false</td>
<td>(A ~= B) 为 true。</td>
</tr>
<tr>
<td>&gt;</td>
<td>大于，如果左边的值大于右边的值，返回 true，否则返回 false</td>
<td>(A &gt; B) 为 false。</td>
</tr>
<tr>
<td>&lt;</td>
<td>小于，如果左边的值大于右边的值，返回 false，否则返回 true</td>
<td>(A &lt; B) 为 true。</td>
</tr>
<tr>
<td>&gt;=</td>
<td>大于等于，如果左边的值大于等于右边的值，返回 true，否则返回 false</td>
<td>(A &gt;= B) 返回 false。</td>
</tr>
<tr>
<td>&lt;=</td>
<td>小于等于， 如果左边的值小于等于右边的值，返回 true，否则返回 false</td>
<td>(A &lt;= B) 返回 true。</td>
</tr>
</tbody>
</table>
<ul>
<li>我们可以通过以下实例来更加透彻的理解关系运算符的应用：</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="mi">21</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span> <span class="o">=</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">if</span><span class="p">(</span> <span class="n">a</span> <span class="o">==</span> <span class="n">b</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">then</span>
</span></span><span class="line"><span class="cl">   <span class="n">print</span><span class="p">(</span><span class="s2">&#34;Line 1 - a 等于 b&#34;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">else</span>
</span></span><span class="line"><span class="cl">   <span class="n">print</span><span class="p">(</span><span class="s2">&#34;Line 1 - a 不等于 b&#34;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">if</span><span class="p">(</span> <span class="n">a</span> <span class="o">~=</span> <span class="n">b</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">then</span>
</span></span><span class="line"><span class="cl">   <span class="n">print</span><span class="p">(</span><span class="s2">&#34;Line 2 - a 不等于 b&#34;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">else</span>
</span></span><span class="line"><span class="cl">   <span class="n">print</span><span class="p">(</span><span class="s2">&#34;Line 2 - a 等于 b&#34;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">if</span> <span class="p">(</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">then</span>
</span></span><span class="line"><span class="cl">   <span class="n">print</span><span class="p">(</span><span class="s2">&#34;Line 3 - a 小于 b&#34;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">else</span>
</span></span><span class="line"><span class="cl">   <span class="n">print</span><span class="p">(</span><span class="s2">&#34;Line 3 - a 大于等于 b&#34;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">if</span> <span class="p">(</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="n">b</span> <span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="kr">then</span>
</span></span><span class="line"><span class="cl">   <span class="n">print</span><span class="p">(</span><span class="s2">&#34;Line 4 - a 大于 b&#34;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">else</span>
</span></span><span class="line"><span class="cl">   <span class="n">print</span><span class="p">(</span><span class="s2">&#34;Line 5 - a 小于等于 b&#34;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">-- 修改 a 和 b 的值</span>
</span></span><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="mi">5</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span> <span class="o">=</span> <span class="mi">20</span>
</span></span><span class="line"><span class="cl"><span class="kr">if</span> <span class="p">(</span> <span class="n">a</span> <span class="o">&lt;=</span> <span class="n">b</span> <span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="kr">then</span>
</span></span><span class="line"><span class="cl">   <span class="n">print</span><span class="p">(</span><span class="s2">&#34;Line 5 - a 小于等于  b&#34;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">if</span> <span class="p">(</span> <span class="n">b</span> <span class="o">&gt;=</span> <span class="n">a</span> <span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="kr">then</span>
</span></span><span class="line"><span class="cl">   <span class="n">print</span><span class="p">(</span><span class="s2">&#34;Line 6 - b 大于等于 a&#34;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- 脚本输出：</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- Line 1 - a 不等于 b</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- Line 2 - a 不等于 b</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- Line 3 - a 大于等于 b</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- Line 4 - a 大于 b</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- Line 5 - a 小于等于  b</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- Line 6 - b 大于等于 a</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="逻辑运算符">逻辑运算符</h3>
<p>下表列出了 Lua 语言中的常用逻辑运算符，设定 A 的值为 true，B 的值为 false：</p>
<table>
<thead>
<tr>
<th>操作符</th>
<th>描述</th>
<th>实例</th>
</tr>
</thead>
<tbody>
<tr>
<td>and</td>
<td>逻辑与操作符。 若 A 为 false，则返回 A，否则返回 B。</td>
<td>(A and B) 为 false。</td>
</tr>
<tr>
<td>or</td>
<td>逻辑或操作符。 若 A 为 true，则返回 A，否则返回 B。</td>
<td>(A or B) 为 true。</td>
</tr>
<tr>
<td>not</td>
<td>逻辑非操作符。与逻辑运算结果相反，如果条件为 true，逻辑非为 false。</td>
<td>not(A and B) 为 true。</td>
</tr>
</tbody>
</table>
<p>我们可以通过以下实例来更加透彻的理解逻辑运算符的应用：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span> <span class="o">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">if</span> <span class="p">(</span> <span class="n">a</span> <span class="ow">and</span> <span class="n">b</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">then</span>
</span></span><span class="line"><span class="cl">   <span class="n">print</span><span class="p">(</span><span class="s2">&#34;a and b - 条件为 true&#34;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">if</span> <span class="p">(</span> <span class="n">a</span> <span class="ow">or</span> <span class="n">b</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">then</span>
</span></span><span class="line"><span class="cl">   <span class="n">print</span><span class="p">(</span><span class="s2">&#34;a or b - 条件为 true&#34;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;---------分割线---------&#34;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">-- 修改 a 和 b 的值</span>
</span></span><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span> <span class="o">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">if</span> <span class="p">(</span> <span class="n">a</span> <span class="ow">and</span> <span class="n">b</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">then</span>
</span></span><span class="line"><span class="cl">   <span class="n">print</span><span class="p">(</span><span class="s2">&#34;a and b - 条件为 true&#34;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">else</span>
</span></span><span class="line"><span class="cl">   <span class="n">print</span><span class="p">(</span><span class="s2">&#34;a and b - 条件为 false&#34;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">if</span> <span class="p">(</span> <span class="ow">not</span><span class="p">(</span> <span class="n">a</span> <span class="ow">and</span> <span class="n">b</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">then</span>
</span></span><span class="line"><span class="cl">   <span class="n">print</span><span class="p">(</span><span class="s2">&#34;not( a and b) - 条件为 true&#34;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">else</span>
</span></span><span class="line"><span class="cl">   <span class="n">print</span><span class="p">(</span><span class="s2">&#34;not( a and b) - 条件为 false&#34;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">--输出</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- a and b - 条件为 true</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- a or b - 条件为 true</span>
</span></span><span class="line"><span class="cl"><span class="c1">---------分割线---------</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- a and b - 条件为 false</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- not( a and b) - 条件为 true</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="其他运算符">其他运算符</h3>
<table>
<thead>
<tr>
<th>操作符</th>
<th>描述</th>
<th>实例</th>
</tr>
</thead>
<tbody>
<tr>
<td>..</td>
<td>连接两个字符串</td>
<td>a..b ，其中 a 为 &ldquo;Hello &quot; ， b 为 &ldquo;World&rdquo;, 输出结果为 &ldquo;Hello World&rdquo;。</td>
</tr>
<tr>
<td>#</td>
<td>一元运算符，返回字符串或表的长度。</td>
<td>#&ldquo;Hello&rdquo; 返回 5</td>
</tr>
</tbody>
</table>
<p>我们可以通过以下实例来更加透彻的理解连接运算符与计算表或字符串长度的运算符的应用：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="s2">&#34;Hello &#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span> <span class="o">=</span> <span class="s2">&#34;World&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;连接字符串 a 和 b &#34;</span><span class="p">,</span> <span class="n">a</span><span class="o">..</span><span class="n">b</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;b 字符串长度 &#34;</span><span class="p">,</span><span class="o">#</span><span class="n">b</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;字符串 Test 长度 &#34;</span><span class="p">,</span><span class="o">#</span><span class="s2">&#34;Test&#34;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;节点精灵网址长度 &#34;</span><span class="p">,</span><span class="o">#</span><span class="s2">&#34;www.nspirit.cn&#34;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">-- 以上程序执行结果为：</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- 连接字符串 a 和 b     Hello World</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- b 字符串长度     5</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- 字符串 Test 长度     4</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- 菜鸟教程网址长度     14</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="运算符优先级">运算符优先级</h3>
<p>从高到低的顺序：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="o">^</span>
</span></span><span class="line"><span class="cl"><span class="ow">not</span>    <span class="o">-</span> <span class="p">(</span><span class="n">unary</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">*</span>      <span class="o">/</span>       <span class="o">%</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>      <span class="o">-</span>
</span></span><span class="line"><span class="cl"><span class="o">..</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span>      <span class="o">&gt;</span>      <span class="o">&lt;=</span>     <span class="o">&gt;=</span>     <span class="o">~=</span>     <span class="o">==</span>
</span></span><span class="line"><span class="cl"><span class="ow">and</span>
</span></span><span class="line"><span class="cl"><span class="ow">or</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>除了 ^ 和 .. 外所有的二元运算符都是左连接的。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">a</span><span class="o">+</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">b</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span>          <span class="o">&lt;--&gt;</span>       <span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;</span> <span class="p">((</span><span class="n">b</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="mi">5</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="mi">8</span>              <span class="o">&lt;--&gt;</span>       <span class="mi">5</span><span class="o">+</span><span class="p">((</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">a</span> <span class="o">&lt;</span> <span class="n">y</span> <span class="ow">and</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="n">z</span>     <span class="o">&lt;--&gt;</span>       <span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="n">y</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">y</span> <span class="o">&lt;=</span> <span class="n">z</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span>                 <span class="o">&lt;--&gt;</span>       <span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span><span class="o">^</span><span class="n">y</span><span class="o">^</span><span class="n">z</span>                <span class="o">&lt;--&gt;</span>       <span class="n">x</span><span class="o">^</span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="n">z</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>我们可以通过以下实例来更加透彻的了解 Lua 语言运算符的优先级：</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="mi">20</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span> <span class="o">=</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="mi">15</span>
</span></span><span class="line"><span class="cl"><span class="n">d</span> <span class="o">=</span> <span class="mi">5</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">e</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="n">c</span> <span class="o">/</span> <span class="n">d</span><span class="p">;</span><span class="c1">-- ( 30 * 15 ) / 5</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;(a + b) * c / d 运算值为  :&#34;</span><span class="o">..</span><span class="n">e</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">e</span> <span class="o">=</span> <span class="p">((</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="n">c</span><span class="p">)</span> <span class="o">/</span> <span class="n">d</span><span class="p">;</span> <span class="c1">-- (30 * 15 ) / 5</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;((a + b) * c) / d 运算值为 :&#34;</span><span class="o">..</span><span class="n">e</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">e</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span> <span class="o">/</span> <span class="n">d</span><span class="p">);</span><span class="c1">-- (30) * (15/5)</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;(a + b) * (c / d) 运算值为 :&#34;</span><span class="o">..</span><span class="n">e</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">e</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="p">(</span><span class="n">b</span> <span class="o">*</span> <span class="n">c</span><span class="p">)</span> <span class="o">/</span> <span class="n">d</span><span class="p">;</span>  <span class="c1">-- 20 + (150/5)</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;a + (b * c) / d 运算值为   :&#34;</span><span class="o">..</span><span class="n">e</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">--输出结果</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- (a + b) * c / d 运算值为  :     90.0</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- ((a + b) * c) / d 运算值为 :    90.0</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- (a + b) * (c / d) 运算值为 :    90.0</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- a + (b * c) / d 运算值为   :    50.0</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="字符串">字符串</h2>
<p>字符串或串(String)是由数字、字母、下划线组成的一串字符。</p>
<p>Lua 语言中字符串可以使用以下三种方式来表示：</p>
<ul>
<li>单引号间的一串字符。</li>
<li>双引号间的一串字符。</li>
<li>[[ 与 ]] 间的一串字符。</li>
</ul>
<p>以上三种方式的字符串实例如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">string1</span> <span class="o">=</span> <span class="s2">&#34;Lua&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\&#34;</span><span class="s2">字符串 1 是</span><span class="se">\&#34;</span><span class="s2">&#34;</span><span class="o">..</span><span class="n">string1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">string2</span> <span class="o">=</span> <span class="s1">&#39;nspirit.com&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;字符串 2 是&#34;</span><span class="o">..</span><span class="n">string2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">string3</span> <span class="o">=</span> <span class="s">[[&#34;Lua 教程&#34;]]</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;字符串 3 是&#34;</span><span class="o">..</span><span class="n">string3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">-- &#34;字符串 1 是&#34;    Lua</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- 字符串 2 是    nspirit.cn</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- 字符串 3 是    &#34;Lua 教程&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="转义字符">转义字符</h3>
<p>转义字符用于表示不能直接显示的字符，比如后退键，回车键，等。如在字符串转换双引号可以使用 &ldquo;&quot;&quot;。</p>
<p>所有的转义字符和所对应的意义：</p>
<table>
<thead>
<tr>
<th>转义字符</th>
<th>意义</th>
<th>ASCII码值（十进制）</th>
</tr>
</thead>
<tbody>
<tr>
<td>\a</td>
<td>响铃(BEL)</td>
<td>007</td>
</tr>
<tr>
<td>\b</td>
<td>退格(BS) ，将当前位置移到前一列</td>
<td>008</td>
</tr>
<tr>
<td>\f</td>
<td>换页(FF)，将当前位置移到下页开头</td>
<td>012</td>
</tr>
<tr>
<td>\n</td>
<td>换行(LF) ，将当前位置移到下一行开头</td>
<td>010</td>
</tr>
<tr>
<td>\r</td>
<td>回车(CR) ，将当前位置移到本行开头</td>
<td>013</td>
</tr>
<tr>
<td>\t</td>
<td>水平制表(HT) （跳到下一个TAB位置）</td>
<td>009</td>
</tr>
<tr>
<td>\v</td>
<td>垂直制表(VT)</td>
<td>011</td>
</tr>
<tr>
<td>\</td>
<td>代表一个反斜线字符&rsquo;''</td>
<td>092</td>
</tr>
<tr>
<td>'</td>
<td>代表一个单引号（撇号）字符</td>
<td>039</td>
</tr>
<tr>
<td>&quot;</td>
<td>代表一个双引号字符</td>
<td>034</td>
</tr>
<tr>
<td>\0</td>
<td>空字符(NULL)</td>
<td>000</td>
</tr>
<tr>
<td>\ddd</td>
<td>1到3位八进制数所代表的任意字符</td>
<td>三位八进制</td>
</tr>
<tr>
<td>\xhh</td>
<td>1到2位十六进制所代表的任意字符</td>
<td>二位十六进制</td>
</tr>
</tbody>
</table>
<h3 id="字符串操作">字符串操作</h3>
<p>Lua 提供了很多的方法来支持字符串的操作：</p>
<ul>
<li>字符串全部转为大写字母。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">res</span> <span class="o">=</span> <span class="n">string.upper</span><span class="p">(</span><span class="s2">&#34;abcde&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="c1">--&gt; ABCDE</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>字符串全部转为小写字母。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">res</span> <span class="o">=</span> <span class="n">string.lower</span><span class="p">(</span><span class="s2">&#34;AbCe&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="c1">--&gt; abce</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>在字符串中替换。 string.gsub(mainString,findString,replaceString,num)</li>
</ul>
<p>mainString 为要操作的字符串， findString 为被替换的字符，replaceString 要替换的字符，num 替换次数（可以忽略，则全部替换），如：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">string.gsub</span><span class="p">(</span><span class="s2">&#34;aaaa&#34;</span><span class="p">,</span><span class="s2">&#34;a&#34;</span><span class="p">,</span><span class="s2">&#34;z&#34;</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- zzza 3</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>在一个指定的目标字符串 str 中搜索指定的内容 substr，如果找到了一个匹配的子串，就会返回这个子串的起始索引和结束索引，不存在则返回 nil。</li>
</ul>
<p>以下实例查找字符串 &ldquo;Lua&rdquo; 的起始索引和结束索引位置：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">string.find</span><span class="p">(</span><span class="s2">&#34;Hello Lua user&#34;</span><span class="p">,</span> <span class="s2">&#34;Lua&#34;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1">--&gt; 7  9</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>字符串反转 string.reverse(arg)</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">res</span> <span class="o">=</span> <span class="n">string.reverse</span><span class="p">(</span><span class="s2">&#34;Lua&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="c1">--&gt; auL</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>返回一个类似printf的格式化字符串 string.format(&hellip;)</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">res</span> <span class="o">=</span>  <span class="n">string.format</span><span class="p">(</span><span class="s2">&#34;the value is:%d&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="c1">--&gt;the value is:4</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>char 将整型数字转成字符并连接， byte 转换字符为整数值(可以指定某个字符，默认第一个字符)。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">res</span> <span class="o">=</span> <span class="n">string.char</span><span class="p">(</span><span class="mi">97</span><span class="p">,</span><span class="mi">98</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="c1">--&gt; abcd</span>
</span></span><span class="line"><span class="cl"><span class="n">res</span> <span class="o">=</span>  <span class="n">string.byte</span><span class="p">(</span><span class="s2">&#34;ABCD&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="c1">--&gt; 68</span>
</span></span><span class="line"><span class="cl"><span class="n">res</span> <span class="o">=</span> <span class="n">string.byte</span><span class="p">(</span><span class="s2">&#34;ABCD&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="c1">--&gt; 65</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>计算字符串长度。 string.len(arg)</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">res</span> <span class="o">=</span> <span class="n">string.len</span><span class="p">(</span><span class="s2">&#34;abc&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>返回字符串string的n个拷贝 string.rep(string, n)</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">string.rep</span><span class="p">(</span><span class="s2">&#34;abcd&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">--&gt; abcdabcd</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>链接两个字符串 ..</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;www.nspirit.&#34;</span><span class="o">..</span><span class="s2">&#34;cn&#34;</span><span class="p">)</span> <span class="c1">--&gt; www.nspirit.cn</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>回一个迭代器函数，每一次调用这个函数，返回一个在字符串 str 找到的下一个符合 pattern 描述的子串。如果参数 pattern 描述的字符串没有找到，迭代函数返回nil。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="kr">for</span> <span class="n">word</span> <span class="kr">in</span> <span class="n">string.gmatch</span><span class="p">(</span><span class="s2">&#34;Hello Lua user&#34;</span><span class="p">,</span> <span class="s2">&#34;%a+&#34;</span><span class="p">)</span> <span class="kr">do</span> <span class="n">print</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="kr">end</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- 输出结果</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- Hello</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- Lua</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- user</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>string.match()只寻找源字串str中的第一个配对. 参数init可选, 指定搜寻过程的起点, 默认为1。</li>
</ul>
<p>在成功配对时, 函数将返回配对表达式中的所有捕获结果; 如果没有设置捕获标记, 则返回整个配对字符串. 当没有成功的配对时, 返回nil。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">string.match</span><span class="p">(</span><span class="s2">&#34;I have 2 questions for you.&#34;</span><span class="p">,</span> <span class="s2">&#34;%d+ %a+&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">--&gt; 2 questions</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">string.format</span><span class="p">(</span><span class="s2">&#34;%d, %q&#34;</span><span class="p">,</span> <span class="n">string.match</span><span class="p">(</span><span class="s2">&#34;I have 2 questions for you.&#34;</span><span class="p">,</span> <span class="s2">&#34;(%d+) (%a+)&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="c1">--&gt; 2, &#34;questions&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="字符串截取">字符串截取</h3>
<p>字符串截取使用 sub() 方法。</p>
<p>string.sub() 用于截取字符串，原型为：</p>
<p>string.sub(s, i [, j])</p>
<p>参数说明：</p>
<ul>
<li>s：要截取的字符串。</li>
<li>i：截取开始位置。</li>
<li>j：截取结束位置，默认为 -1，最后一个字符。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="c1">-- 字符串</span>
</span></span><span class="line"><span class="cl"><span class="kd">local</span> <span class="n">sourcestr</span> <span class="o">=</span> <span class="s2">&#34;prefix--nspiritgoogletaobao--suffix&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">原始字符串&#34;</span><span class="o">..</span> <span class="n">string.format</span><span class="p">(</span><span class="s2">&#34;%q&#34;</span><span class="p">,</span> <span class="n">sourcestr</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">-- 截取部分，第4个到第15个</span>
</span></span><span class="line"><span class="cl"><span class="kd">local</span> <span class="n">first_sub</span> <span class="o">=</span> <span class="n">string.sub</span><span class="p">(</span><span class="n">sourcestr</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">第一次截取&#34;</span><span class="o">..</span> <span class="n">string.format</span><span class="p">(</span><span class="s2">&#34;%q&#34;</span><span class="p">,</span> <span class="n">first_sub</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">-- 取字符串前缀，第1个到第8个</span>
</span></span><span class="line"><span class="cl"><span class="kd">local</span> <span class="n">second_sub</span> <span class="o">=</span> <span class="n">string.sub</span><span class="p">(</span><span class="n">sourcestr</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">第二次截取&#34;</span><span class="o">..</span> <span class="n">string.format</span><span class="p">(</span><span class="s2">&#34;%q&#34;</span><span class="p">,</span> <span class="n">second_sub</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">-- 截取最后10个</span>
</span></span><span class="line"><span class="cl"><span class="kd">local</span> <span class="n">third_sub</span> <span class="o">=</span> <span class="n">string.sub</span><span class="p">(</span><span class="n">sourcestr</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">第三次截取&#34;</span><span class="o">..</span> <span class="n">string.format</span><span class="p">(</span><span class="s2">&#34;%q&#34;</span><span class="p">,</span> <span class="n">third_sub</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">-- 索引越界，输出原始字符串</span>
</span></span><span class="line"><span class="cl"><span class="kd">local</span> <span class="n">fourth_sub</span> <span class="o">=</span> <span class="n">string.sub</span><span class="p">(</span><span class="n">sourcestr</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">第四次截取&#34;</span><span class="o">..</span> <span class="n">string.format</span><span class="p">(</span><span class="s2">&#34;%q&#34;</span><span class="p">,</span> <span class="n">fourth_sub</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="字符串格式化">字符串格式化</h3>
<p>Lua 提供了 string.format() 函数来生成具有特定格式的字符串, 函数的第一个参数是格式 , 之后是对应格式中每个代号的各种数据。</p>
<p>由于格式字符串的存在, 使得产生的长字符串可读性大大提高了。这个函数的格式很像 C 语言中的 printf()。</p>
<p>以下实例演示了如何对字符串进行格式化操作：</p>
<p>格式字符串可能包含以下的转义码:</p>
<ul>
<li>%c - 接受一个数字, 并将其转化为ASCII码表中对应的字符</li>
<li>%d, %i - 接受一个数字并将其转化为有符号的整数格式</li>
<li>%o - 接受一个数字并将其转化为八进制数格式</li>
<li>%u - 接受一个数字并将其转化为无符号整数格式</li>
<li>%x - 接受一个数字并将其转化为十六进制数格式, 使用小写字母</li>
<li>%X - 接受一个数字并将其转化为十六进制数格式, 使用大写字母</li>
<li>%e - 接受一个数字并将其转化为科学记数法格式, 使用小写字母e</li>
<li>%E - 接受一个数字并将其转化为科学记数法格式, 使用大写字母E</li>
<li>%f - 接受一个数字并将其转化为浮点数格式</li>
<li>%g(%G) - 接受一个数字并将其转化为%e(%E, 对应%G)及%f中较短的一种格式</li>
<li>%q - 接受一个字符串并将其转化为可安全被Lua编译器读入的格式</li>
<li>%s - 接受一个字符串并按照给定的参数格式化该字符串 为进一步细化格式, 可以在%号后添加参数. 参数将以如下的顺序读入:</li>
<li>(1) 符号: 一个+号表示其后的数字转义符将让正数显示正号. 默认情况下只有负数显示符号.</li>
<li>(2) 占位符: 一个0, 在后面指定了字串宽度时占位用. 不填时的默认占位符是空格.</li>
<li>(3) 对齐标识: 在指定了字串宽度时, 默认为右对齐, 增加-号可以改为左对齐.</li>
<li>(4) 宽度数值</li>
<li>(5) 小数位数/字串裁切: 在宽度数值后增加的小数部分n, 若后接f(浮点数转义符, 如%6.3f)则设定该浮点数的小数只保留n位, 若后接s(字符串转义符, 如%5.3s)则设定该字符串只显示前n位.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">string1</span> <span class="o">=</span> <span class="s2">&#34;Lua&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">string2</span> <span class="o">=</span> <span class="s2">&#34;Tutorial&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">number1</span> <span class="o">=</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl"><span class="n">number2</span> <span class="o">=</span> <span class="mi">20</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- 基本字符串格式化</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">string.format</span><span class="p">(</span><span class="s2">&#34;基本格式化 %s %s&#34;</span><span class="p">,</span><span class="n">string1</span><span class="p">,</span><span class="n">string2</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- 日期格式化</span>
</span></span><span class="line"><span class="cl"><span class="n">date</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">month</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">year</span> <span class="o">=</span> <span class="mi">2014</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">string.format</span><span class="p">(</span><span class="s2">&#34;日期格式化 %02d/%02d/%03d&#34;</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">year</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- 十进制格式化</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">string.format</span><span class="p">(</span><span class="s2">&#34;%.4f&#34;</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>其他例子</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">string.format</span><span class="p">(</span><span class="s2">&#34;%c&#34;</span><span class="p">,</span> <span class="mi">83</span><span class="p">)</span>                 <span class="c1">-- 输出S</span>
</span></span><span class="line"><span class="cl"><span class="n">string.format</span><span class="p">(</span><span class="s2">&#34;%+d&#34;</span><span class="p">,</span> <span class="mf">17.0</span><span class="p">)</span>              <span class="c1">-- 输出+17</span>
</span></span><span class="line"><span class="cl"><span class="n">string.format</span><span class="p">(</span><span class="s2">&#34;%05d&#34;</span><span class="p">,</span> <span class="mi">17</span><span class="p">)</span>               <span class="c1">-- 输出00017</span>
</span></span><span class="line"><span class="cl"><span class="n">string.format</span><span class="p">(</span><span class="s2">&#34;%o&#34;</span><span class="p">,</span> <span class="mi">17</span><span class="p">)</span>                 <span class="c1">-- 输出21</span>
</span></span><span class="line"><span class="cl"><span class="n">string.format</span><span class="p">(</span><span class="s2">&#34;%u&#34;</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">)</span>               <span class="c1">-- 输出3</span>
</span></span><span class="line"><span class="cl"><span class="n">string.format</span><span class="p">(</span><span class="s2">&#34;%x&#34;</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>                 <span class="c1">-- 输出d</span>
</span></span><span class="line"><span class="cl"><span class="n">string.format</span><span class="p">(</span><span class="s2">&#34;%X&#34;</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>                 <span class="c1">-- 输出D</span>
</span></span><span class="line"><span class="cl"><span class="n">string.format</span><span class="p">(</span><span class="s2">&#34;%e&#34;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>               <span class="c1">-- 输出1.000000e+03</span>
</span></span><span class="line"><span class="cl"><span class="n">string.format</span><span class="p">(</span><span class="s2">&#34;%E&#34;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>               <span class="c1">-- 输出1.000000E+03</span>
</span></span><span class="line"><span class="cl"><span class="n">string.format</span><span class="p">(</span><span class="s2">&#34;%6.3f&#34;</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>              <span class="c1">-- 输出13.000</span>
</span></span><span class="line"><span class="cl"><span class="n">string.format</span><span class="p">(</span><span class="s2">&#34;%q&#34;</span><span class="p">,</span> <span class="s2">&#34;One</span><span class="se">\n</span><span class="s2">Two&#34;</span><span class="p">)</span>         <span class="c1">-- 输出&#34;One\</span>
</span></span><span class="line"><span class="cl">                                        <span class="c1">-- 　　Two&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">string.format</span><span class="p">(</span><span class="s2">&#34;%s&#34;</span><span class="p">,</span> <span class="s2">&#34;monkey&#34;</span><span class="p">)</span>           <span class="c1">-- 输出monkey</span>
</span></span><span class="line"><span class="cl"><span class="n">string.format</span><span class="p">(</span><span class="s2">&#34;%10s&#34;</span><span class="p">,</span> <span class="s2">&#34;monkey&#34;</span><span class="p">)</span>         <span class="c1">-- 输出    monkey</span>
</span></span><span class="line"><span class="cl"><span class="n">string.format</span><span class="p">(</span><span class="s2">&#34;%5.3s&#34;</span><span class="p">,</span> <span class="s2">&#34;monkey&#34;</span><span class="p">)</span>        <span class="c1">-- 输出  mon</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="字符与整数相互转换">字符与整数相互转换</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="c1">-- 字符转换</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- 转换第一个字符</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">string.byte</span><span class="p">(</span><span class="s2">&#34;Lua&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- 转换第三个字符</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">string.byte</span><span class="p">(</span><span class="s2">&#34;Lua&#34;</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- 转换末尾第一个字符</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">string.byte</span><span class="p">(</span><span class="s2">&#34;Lua&#34;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- 第二个字符</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">string.byte</span><span class="p">(</span><span class="s2">&#34;Lua&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- 转换末尾第二个字符</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">string.byte</span><span class="p">(</span><span class="s2">&#34;Lua&#34;</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">-- 整数 ASCII 码转换为字符</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">string.char</span><span class="p">(</span><span class="mi">97</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">--[[
</span></span></span><span class="line"><span class="cl"><span class="cm">输出如下：
</span></span></span><span class="line"><span class="cl"><span class="cm">76
</span></span></span><span class="line"><span class="cl"><span class="cm">97
</span></span></span><span class="line"><span class="cl"><span class="cm">97
</span></span></span><span class="line"><span class="cl"><span class="cm">117
</span></span></span><span class="line"><span class="cl"><span class="cm">117
</span></span></span><span class="line"><span class="cl"><span class="cm">a
</span></span></span><span class="line"><span class="cl"><span class="cm">--]]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="匹配模式">匹配模式</h3>
<p>Lua 中的匹配模式直接用常规的字符串来描述。 它用于模式匹配函数 string.find, string.gmatch, string.gsub, string.match。</p>
<p>你还可以在模式串中使用字符类。</p>
<p>字符类指可以匹配一个特定字符集合内任何字符的模式项。比如，字符类 %d 匹配任意数字。所以你可以使用模式串 %d%d/%d%d/%d%d%d%d 搜索 dd/mm/yyyy 格式的日期：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">s</span> <span class="o">=</span> <span class="s2">&#34;Deadline is 30/05/1999, firm&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">date</span> <span class="o">=</span> <span class="s2">&#34;%d%d/%d%d/%d%d%d%d&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">string.sub</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">string.find</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">date</span><span class="p">)))</span>    <span class="c1">--&gt; 30/05/1999</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>下面的表列出了Lua支持的所有字符类：</p>
<p>单个字符(除 ^$()%.[]*+-? 外): 与该字符自身配对</p>
<ul>
<li>
<p>.(点): 与任何字符配对</p>
</li>
<li>
<p>%a: 与任何字母配对</p>
</li>
<li>
<p>%c: 与任何控制符配对(例如\n)</p>
</li>
<li>
<p>%d: 与任何数字配对</p>
</li>
<li>
<p>%l: 与任何小写字母配对</p>
</li>
<li>
<p>%p: 与任何标点(punctuation)配对</p>
</li>
<li>
<p>%s: 与空白字符配对</p>
</li>
<li>
<p>%u: 与任何大写字母配对</p>
</li>
<li>
<p>%w: 与任何字母/数字配对</p>
</li>
<li>
<p>%x: 与任何十六进制数配对</p>
</li>
<li>
<p>%z: 与任何代表0的字符配对</p>
</li>
<li>
<p>%x(此处x是非字母非数字字符): 与字符x配对. 主要用来处理表达式中有功能的字符(^$()%.[]*+-?)的配对问题, 例如%%与%配对</p>
</li>
<li>
<p>[数个字符类]: 与任何[]中包含的字符类配对. 例如[%w_]与任何字母/数字, 或下划线符号(_)配对</p>
</li>
<li></li>
</ul>
<p>当上述的字符类用大写书写时, 表示与非此字符类的任何字符配对. 例如, %S表示与任何非空白字符配对.例如，&rsquo;%A&rsquo;非字母的字符:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="kd">local</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">=</span> <span class="n">string.gsub</span><span class="p">(</span><span class="s2">&#34;hello, up-down!&#34;</span><span class="p">,</span> <span class="s2">&#34;%A&#34;</span><span class="p">,</span> <span class="s2">&#34;.&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">a</span><span class="o">..</span><span class="n">b</span><span class="p">)</span> <span class="c1">--&gt;hello..up.down.4</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>数字4不是字符串结果的一部分，他是gsub返回的第二个结果，代表发生替换的次数。</p>
<p>在模式匹配中有一些特殊字符，他们有特殊的意义，Lua中的特殊字符如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="p">(</span> <span class="p">)</span> <span class="p">.</span> <span class="o">%</span> <span class="o">+</span> <span class="o">-</span> <span class="o">*</span> <span class="err">?</span> <span class="p">[</span> <span class="o">^</span> <span class="err">$</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>&lsquo;%&rsquo; 用作特殊字符的转义字符，因此 &lsquo;%.&rsquo; 匹配点；&rsquo;%%&rsquo; 匹配字符 &lsquo;%&rsquo;。转义字符 &lsquo;%&lsquo;不仅可以用来转义特殊字符，还可以用于所有的非字母的字符。</p>
<ul>
<li>单个字符类匹配该类别中任意单个字符；</li>
<li>单个字符类跟一个 &lsquo;*&rsquo;， 将匹配零或多个该类的字符。 这个条目总是匹配尽可能长的串；</li>
<li>单个字符类跟一个 &lsquo;+&rsquo;， 将匹配一或更多个该类的字符。 这个条目总是匹配尽可能长的串；</li>
<li>单个字符类跟一个 &lsquo;-&rsquo;， 将匹配零或更多个该类的字符。 和 &lsquo;*&rsquo; 不同， 这个条目总是匹配尽可能短的串；</li>
<li>单个字符类跟一个 &lsquo;?&rsquo;， 将匹配零或一个该类的字符。 只要有可能，它会匹配一个；</li>
<li>%n， 这里的 n 可以从 1 到 9； 这个条目匹配一个等于 n 号捕获物（后面有描述）的子串。</li>
<li>%bxy， 这里的 x 和 y 是两个明确的字符； 这个条目匹配以 x 开始 y 结束， 且其中 x 和 y 保持 平衡 的字符串。 意思是，如果从左到右读这个字符串，对每次读到一个 x 就 +1 ，读到一个 y 就 -1， 最终结束处的那个 y 是第一个记数到 0 的 y。 举个例子，条目 %b() 可以匹配到括号平衡的表达式。</li>
<li>%f[set]， 指 边境模式； 这个条目会匹配到一个位于 set 内某个字符之前的一个空串， 且这个位置的前一个字符不属于 set 。 集合 set 的含义如前面所述。 匹配出的那个空串之开始和结束点的计算就看成该处有个字符 &lsquo;\0&rsquo; 一样。</li>
</ul>
<h4 id="模式">模式：</h4>
<p>模式 指一个模式条目的序列。 在模式最前面加上符号 &lsquo;^&rsquo; 将锚定从字符串的开始处做匹配。 在模式最后面加上符号 &lsquo;$&rsquo; 将使匹配过程锚定到字符串的结尾。 如果 &lsquo;^&rsquo; 和 &lsquo;$&rsquo; 出现在其它位置，它们均没有特殊含义，只表示自身。</p>
<h4 id="捕获">捕获：</h4>
<p>模式可以在内部用小括号括起一个子模式； 这些子模式被称为 捕获物。 当匹配成功时，由 捕获物 匹配到的字符串中的子串被保存起来用于未来的用途。 捕获物以它们左括号的次序来编号。 例如，对于模式 &ldquo;(a*(.)%w(%s*))&rdquo; ， 字符串中匹配到 &ldquo;a*(.)%w(%s*)&rdquo; 的部分保存在第一个捕获物中 （因此是编号 1 ）； 由 &ldquo;.&rdquo; 匹配到的字符是 2 号捕获物， 匹配到 &ldquo;%s*&rdquo; 的那部分是 3 号。 作为一个特例，空的捕获 () 将捕获到当前字符串的位置（它是一个数字）。 例如，如果将模式 &ldquo;()aa()&rdquo; 作用到字符串 &ldquo;flaaap&rdquo; 上，将产生两个捕获物： 3 和 5 。</p>
<h2 id="表-table">表 table</h2>
<p>table 是 Lua 的一种数据结构用来帮助我们创建不同的数据类型，如：数组、字典等。</p>
<p>Lua table 使用关联型数组，你可以用任意类型的值来作数组的索引，但这个值不能是 nil。</p>
<p>Lua table 是不固定大小的，你可以根据自己需要进行扩容。</p>
<p>Lua也是通过table来解决模块（module）、包（package）和对象（Object）的。 例如string.format表示使用&quot;format&quot;来索引table string。</p>
<h3 id="table表的构造">table(表)的构造</h3>
<p>构造器是创建和初始化表的表达式。表是Lua特有的功能强大的东西。最简单的构造函数是{}，用来创建一个空表。可以直接初始化数组:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="c1">-- 初始化表</span>
</span></span><span class="line"><span class="cl"><span class="n">mytable</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">-- 指定值</span>
</span></span><span class="line"><span class="cl"><span class="n">mytable</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span> <span class="s2">&#34;Lua&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">-- 移除引用</span>
</span></span><span class="line"><span class="cl"><span class="n">mytable</span> <span class="o">=</span> <span class="kc">nil</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- lua 垃圾回收会释放内存</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>当我们为 table a 并设置元素，然后将 a 赋值给 b，则 a 与 b 都指向同一个内存。如果 a 设置为 nil ，则 b 同样能访问 table 的元素。如果没有指定的变量指向a，Lua的垃圾回收机制会清理相对应的内存。 以下实例演示了以上的描述情况：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="c1">-- 简单的 table</span>
</span></span><span class="line"><span class="cl"><span class="n">mytable</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;mytable 的类型是 &#34;</span><span class="o">..</span><span class="n">type</span><span class="p">(</span><span class="n">mytable</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">mytable</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span> <span class="s2">&#34;Lua&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">mytable</span><span class="p">[</span><span class="s2">&#34;wow&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;修改前&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;mytable 索引为 1 的元素是 &#34;</span><span class="o">..</span> <span class="n">mytable</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;mytable 索引为 wow 的元素是 &#34;</span><span class="p">,</span> <span class="n">mytable</span><span class="p">[</span><span class="s2">&#34;wow&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">-- alternatetable和mytable的是指同一个 table</span>
</span></span><span class="line"><span class="cl"><span class="n">alternatetable</span> <span class="o">=</span> <span class="n">mytable</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;alternatetable 索引为 1 的元素是 &#34;</span><span class="o">..</span> <span class="n">alternatetable</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;mytable 索引为 wow 的元素是 &#34;</span><span class="o">..</span> <span class="n">alternatetable</span><span class="p">[</span><span class="s2">&#34;wow&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">alternatetable</span><span class="p">[</span><span class="s2">&#34;wow&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;修改后&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;mytable 索引为 wow 的元素是 &#34;</span><span class="o">..</span> <span class="n">mytable</span><span class="p">[</span><span class="s2">&#34;wow&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">-- 释放变量</span>
</span></span><span class="line"><span class="cl"><span class="n">alternatetable</span> <span class="o">=</span> <span class="kc">nil</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;alternatetable 是 &#34;</span><span class="o">..</span> <span class="n">alternatetable</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">-- mytable 仍然可以访问</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;mytable 索引为 wow 的元素是 &#34;</span><span class="o">..</span> <span class="n">mytable</span><span class="p">[</span><span class="s2">&#34;wow&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">mytable</span> <span class="o">=</span> <span class="kc">nil</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;mytable 是 &#34;</span><span class="o">..</span> <span class="n">mytable</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- 输出结果是</span>
</span></span><span class="line"><span class="cl"><span class="cm">--[[
</span></span></span><span class="line"><span class="cl"><span class="cm">mytable 的类型是     table
</span></span></span><span class="line"><span class="cl"><span class="cm">mytable 索引为 1 的元素是     Lua
</span></span></span><span class="line"><span class="cl"><span class="cm">mytable 索引为 wow 的元素是     修改前
</span></span></span><span class="line"><span class="cl"><span class="cm">alternatetable 索引为 1 的元素是     Lua
</span></span></span><span class="line"><span class="cl"><span class="cm">mytable 索引为 wow 的元素是     修改前
</span></span></span><span class="line"><span class="cl"><span class="cm">mytable 索引为 wow 的元素是     修改后
</span></span></span><span class="line"><span class="cl"><span class="cm">alternatetable 是     nil
</span></span></span><span class="line"><span class="cl"><span class="cm">mytable 索引为 wow 的元素是     修改后
</span></span></span><span class="line"><span class="cl"><span class="cm">mytable 是     nil
</span></span></span><span class="line"><span class="cl"><span class="cm">]]</span><span class="c1">--</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="table-操作">table 操作</h3>
<p>以下列出了 Table 操作常用的方法：</p>
<ul>
<li>
<ol>
<li>table.concat (table [, sep [, start [, end]]]):</li>
</ol>
</li>
</ul>
<p>concat是concatenate(连锁, 连接)的缩写. table.concat()函数列出参数中指定table的数组部分从start位置到end位置的所有元素, 元素间以指定的分隔符(sep)隔开。</p>
<ul>
<li>
<ol>
<li>table.insert (table, [pos,] value):</li>
</ol>
</li>
</ul>
<p>在table的数组部分指定位置(pos)插入值为value的一个元素. pos参数可选, 默认为数组部分末尾.</p>
<ul>
<li>
<ol>
<li>table.maxn (table)</li>
</ol>
</li>
</ul>
<p>指定table中所有正数key值中最大的key值. 如果不存在key值为正数的元素, 则返回0。(Lua5.2之后该方法已经不存在了,本文使用了自定义函数实现)</p>
<ul>
<li>
<ol>
<li>table.remove (table [, pos])</li>
</ol>
</li>
</ul>
<p>返回table数组部分位于pos位置的元素. 其后的元素会被前移. pos参数可选, 默认为table长度, 即从最后一个元素删起。</p>
<ul>
<li>
<ol>
<li>table.sort (table [, comp])</li>
</ol>
</li>
</ul>
<p>对给定的table进行升序排序。</p>
<h4 id="table-连接">table 连接</h4>
<p>我们可以使用 concat() 输出一个列表中元素连接成的字符串:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">fruits</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;banana&#34;</span><span class="p">,</span><span class="s2">&#34;orange&#34;</span><span class="p">,</span><span class="s2">&#34;apple&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- 返回 table 连接后的字符串</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;连接后的字符串 &#34;</span><span class="o">..</span><span class="n">table.concat</span><span class="p">(</span><span class="n">fruits</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">-- 指定连接字符</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;连接后的字符串 &#34;</span><span class="o">..</span><span class="n">table.concat</span><span class="p">(</span><span class="n">fruits</span><span class="p">,</span><span class="s2">&#34;, &#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">-- 指定索引来连接 table</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;连接后的字符串 &#34;</span><span class="o">..</span><span class="n">table.concat</span><span class="p">(</span><span class="n">fruits</span><span class="p">,</span><span class="s2">&#34;, &#34;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="cm">--[[
</span></span></span><span class="line"><span class="cl"><span class="cm">输出结果
</span></span></span><span class="line"><span class="cl"><span class="cm">连接后的字符串     bananaorangeapple
</span></span></span><span class="line"><span class="cl"><span class="cm">连接后的字符串     banana, orange, apple
</span></span></span><span class="line"><span class="cl"><span class="cm">连接后的字符串     orange, apple
</span></span></span><span class="line"><span class="cl"><span class="cm">]]</span><span class="c1">--</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="插入和移除">插入和移除</h4>
<p>以下实例演示了 table 的插入和移除操作:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">fruits</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;banana&#34;</span><span class="p">,</span><span class="s2">&#34;orange&#34;</span><span class="p">,</span><span class="s2">&#34;apple&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">-- 在末尾插入</span>
</span></span><span class="line"><span class="cl"><span class="n">table.insert</span><span class="p">(</span><span class="n">fruits</span><span class="p">,</span><span class="s2">&#34;mango&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;索引为 4 的元素为 &#34;</span><span class="o">..</span><span class="n">fruits</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">-- 在索引为 2 的键处插入</span>
</span></span><span class="line"><span class="cl"><span class="n">table.insert</span><span class="p">(</span><span class="n">fruits</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s2">&#34;grapes&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;索引为 2 的元素为 &#34;</span><span class="o">..</span><span class="n">fruits</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;最后一个元素为 &#34;</span><span class="p">,</span><span class="n">fruits</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">table.remove</span><span class="p">(</span><span class="n">fruits</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;移除后最后一个元素为 &#34;</span><span class="o">..</span><span class="n">fruits</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- 输出结果</span>
</span></span><span class="line"><span class="cl"><span class="cm">--[[
</span></span></span><span class="line"><span class="cl"><span class="cm">索引为 4 的元素为     mango
</span></span></span><span class="line"><span class="cl"><span class="cm">索引为 2 的元素为     grapes
</span></span></span><span class="line"><span class="cl"><span class="cm">最后一个元素为     mango
</span></span></span><span class="line"><span class="cl"><span class="cm">移除后最后一个元素为     nil
</span></span></span><span class="line"><span class="cl"><span class="cm">]]</span><span class="c1">--</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="table-排序">table 排序</h4>
<p>以下实例演示了 sort() 方法的使用，用于对 Table 进行排序：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">fruits</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;banana&#34;</span><span class="p">,</span><span class="s2">&#34;orange&#34;</span><span class="p">,</span><span class="s2">&#34;apple&#34;</span><span class="p">,</span><span class="s2">&#34;grapes&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;排序前&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="kr">in</span> <span class="n">ipairs</span><span class="p">(</span><span class="n">fruits</span><span class="p">)</span> <span class="kr">do</span>
</span></span><span class="line"><span class="cl">        <span class="n">print</span><span class="p">(</span><span class="n">k</span><span class="o">..</span><span class="n">v</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">table.sort</span><span class="p">(</span><span class="n">fruits</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="s2">&#34;排序后&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="kr">in</span> <span class="n">ipairs</span><span class="p">(</span><span class="n">fruits</span><span class="p">)</span> <span class="kr">do</span>
</span></span><span class="line"><span class="cl">        <span class="n">print</span><span class="p">(</span><span class="n">k</span><span class="o">..</span><span class="n">v</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span><span class="line"><span class="cl"><span class="c1">--输出结果</span>
</span></span><span class="line"><span class="cl"><span class="cm">--[[
</span></span></span><span class="line"><span class="cl"><span class="cm">   排序前
</span></span></span><span class="line"><span class="cl"><span class="cm">1    banana
</span></span></span><span class="line"><span class="cl"><span class="cm">2    orange
</span></span></span><span class="line"><span class="cl"><span class="cm">3    apple
</span></span></span><span class="line"><span class="cl"><span class="cm">4    grapes
</span></span></span><span class="line"><span class="cl"><span class="cm">排序后
</span></span></span><span class="line"><span class="cl"><span class="cm">1    apple
</span></span></span><span class="line"><span class="cl"><span class="cm">2    banana
</span></span></span><span class="line"><span class="cl"><span class="cm">3    grapes
</span></span></span><span class="line"><span class="cl"><span class="cm">4    orange
</span></span></span><span class="line"><span class="cl"><span class="cm">]]</span><span class="c1">--</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="迭代器">迭代器</h2>
<p>迭代器（iterator）是一种对象，它能够用来遍历标准模板库容器中的部分或全部元素，每个迭代器对象代表容器中的确定的地址。</p>
<p>在 Lua 中迭代器是一种支持指针类型的结构，它可以遍历集合的每一个元素。</p>
<h3 id="泛型-for-迭代器">泛型 for 迭代器</h3>
<ul>
<li>泛型 for 在自己内部保存迭代函数，实际上它保存三个值：迭代函数、状态常量、控制变量。</li>
<li>泛型 for 迭代器提供了集合的 key/value 对，语法格式如下：</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="c1">--遍历所有内容,包括键值</span>
</span></span><span class="line"><span class="cl"><span class="kr">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="kr">in</span> <span class="n">pairs</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="kr">do</span>
</span></span><span class="line"><span class="cl">    <span class="n">print</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>上面代码中，k, v为变量列表；pairs(t)为表达式列表。</p>
<p>查看以下实例:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="c1">--遍历下标内容,不包括键值</span>
</span></span><span class="line"><span class="cl"><span class="n">array</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;Google&#34;</span><span class="p">,</span> <span class="s2">&#34;Runoob&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">for</span> <span class="n">key</span><span class="p">,</span><span class="n">value</span> <span class="kr">in</span> <span class="n">ipairs</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="kr">do</span>
</span></span><span class="line"><span class="cl">   <span class="n">print</span><span class="p">(</span><span class="n">key</span><span class="o">..</span> <span class="n">value</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">--输出结果</span>
</span></span><span class="line"><span class="cl"><span class="cm">--[[
</span></span></span><span class="line"><span class="cl"><span class="cm">1  Google
</span></span></span><span class="line"><span class="cl"><span class="cm">2  Runoob
</span></span></span><span class="line"><span class="cl"><span class="cm">]]</span><span class="c1">--</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="模块">模块</h2>
<p>、 在节点精灵 中 require 函数可以加载其他文件中的lua代码</p>
<h3 id="加载路径">加载路径</h3>
<p>在节点精灵里，所有文件加载必须填写绝对路径。</p>
<p>根目录 为 &lsquo;/&rsquo;</p>
<ul>
<li>如图</li>
</ul>
<p><img
        class="lazyload"
        data-src="https://cdn.jsdelivr.net/gh/xinqinew/pic@main/img/filejg.jpg"
        data-srcset="https://cdn.jsdelivr.net/gh/xinqinew/pic@main/img/filejg.jpg, https://cdn.jsdelivr.net/gh/xinqinew/pic@main/img/filejg.jpg 1.5x, https://cdn.jsdelivr.net/gh/xinqinew/pic@main/img/filejg.jpg 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/xinqinew/pic@main/img/filejg.jpg"
        title="img"
    /></p>
<h3 id="文件层级加载相关">文件层级加载相关</h3>
<ul>
<li>相同层级的文件加载如下</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="c1">-- mian.lua</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- a.lua</span>
</span></span><span class="line"><span class="cl"><span class="c1">--在mian.lua 中 如下就可以加载a.lua文件了</span>
</span></span><span class="line"><span class="cl">   <span class="n">require</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>不同层级的文件加载</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="c1">-- mian.lua</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- a(这是文件夹)</span>
</span></span><span class="line"><span class="cl">   <span class="c1">-- b.lua（这是a文件夹中的文件）</span>
</span></span><span class="line"><span class="cl"><span class="c1">--在mian.lua 中 如下就可以加载b.lua文件了</span>
</span></span><span class="line"><span class="cl">   <span class="n">require</span><span class="p">(</span><span class="s1">&#39;a/b&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="多重加载">多重加载</h3>
<p>在节点精灵中， 可以在lua文件中 require 其他文件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="c1">--文件结构如下：</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- mian.lua</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- a.lua</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- b.lua</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">--在mian.lua 中 加载a.lua 在a.lua 中可以加载 b.lua</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>mian.lua 中如下</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl">   <span class="n">require</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>a.lua 中如夏</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl">   <span class="n">require</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>更新于 2022-01-07</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="#" onclick="return false;" title="分享到 Twitter" data-sharer="twitter" data-url="https://xinqinew.github.io/2022/01/lua%E5%9F%BA%E7%A1%80/" data-title="Lua" data-hashtags="Lua"><i class="fab fa-twitter fa-fw"></i></a><a href="#" onclick="return false;" title="分享到 Facebook" data-sharer="facebook" data-url="https://xinqinew.github.io/2022/01/lua%E5%9F%BA%E7%A1%80/" data-hashtag="Lua"><i class="fab fa-facebook-square fa-fw"></i></a><a href="#" onclick="return false;" title="分享到 Hacker News" data-sharer="hackernews" data-url="https://xinqinew.github.io/2022/01/lua%E5%9F%BA%E7%A1%80/" data-title="Lua"><i class="fab fa-hacker-news fa-fw"></i></a><a href="#" onclick="return false;" title="分享到 Line" data-sharer="line" data-url="https://xinqinew.github.io/2022/01/lua%E5%9F%BA%E7%A1%80/" data-title="Lua"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@2.14.0/icons/line.svg"></i></a><a href="#" onclick="return false;" title="分享到 微博" data-sharer="weibo" data-url="https://xinqinew.github.io/2022/01/lua%E5%9F%BA%E7%A1%80/" data-title="Lua"><i class="fab fa-weibo fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/lua/">Lua</a></section>
        <section>
            <span><a href="#" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/2022/01/lua-mac%E7%BC%96%E8%AF%91%E5%92%8C%E5%AE%89%E8%A3%85/" class="prev" rel="prev" title="Lua Mac编译和安装"><i class="fas fa-angle-left fa-fw"></i>Lua Mac编译和安装</a></div>
</div>
<div id="comments"><div id="valine" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://valine.js.org/">Valine</a>.
            </noscript></div></article></div>
        </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">
                    
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2021 - 2025</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://xinqinew.github.io" target="_blank" rel="noopener noreferrer">辛琪</a></span></div>
        </div></footer></div>

    <div id="fixed-buttons"><a href="#back-to-top" id="back-to-top-button" class="fixed-button" title="回到顶部">
            <i class="fas fa-arrow-up fa-fw"></i>
        </a><a href="#" id="view-comments" class="fixed-button" title="查看评论">
            <i class="fas fa-comment fa-fw"></i>
        </a>
    </div><div class="assets"><link rel="stylesheet" href="/css/custom.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.2.2/lazysizes.min.js"></script><script type="text/javascript" src="/lib/topbar/topbar.min.js"></script><script type="text/javascript" src="/lib/pjax/pjax.min.js"></script><script type="text/javascript" src="/js/theme.min.js"></script><script type="text/javascript">
            window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
            gtag('config', 'G-WYTDS8EES7', { 'anonymize_ip': true });
        </script><script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=G-WYTDS8EES7" async></script></div>

<div class="pjax-assets"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/twemoji@13.0.0/dist/twemoji.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery.js@1.2.0/dist/js/lightgallery.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lg-thumbnail.js@1.2.0/dist/lg-thumbnail.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lg-zoom.js@1.2.0/dist/lg-zoom.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.4.0/sharer.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/copy-tex.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/mhchem.min.js"></script><script type="text/javascript" src="/js/custom.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":20},"comment":{"valine":{"appId":"x2nNRFGhoMz8h5ljE0BSH6aQ-gzGzoHsz","appKey":"75BfXlVOixc8e3KwUIBrus4G","avatar":"mp","el":"#valine","emojiCDN":"https://cdn.jsdelivr.net/npm/emoji-datasource-google@5.0.1/img/google/64/","emojiMaps":{"100":"1f4af.png","alien":"1f47d.png","anger":"1f4a2.png","angry":"1f620.png","anguished":"1f627.png","astonished":"1f632.png","black_heart":"1f5a4.png","blue_heart":"1f499.png","blush":"1f60a.png","bomb":"1f4a3.png","boom":"1f4a5.png","broken_heart":"1f494.png","brown_heart":"1f90e.png","clown_face":"1f921.png","cold_face":"1f976.png","cold_sweat":"1f630.png","confounded":"1f616.png","confused":"1f615.png","cry":"1f622.png","crying_cat_face":"1f63f.png","cupid":"1f498.png","dash":"1f4a8.png","disappointed":"1f61e.png","disappointed_relieved":"1f625.png","dizzy":"1f4ab.png","dizzy_face":"1f635.png","drooling_face":"1f924.png","exploding_head":"1f92f.png","expressionless":"1f611.png","face_vomiting":"1f92e.png","face_with_cowboy_hat":"1f920.png","face_with_hand_over_mouth":"1f92d.png","face_with_head_bandage":"1f915.png","face_with_monocle":"1f9d0.png","face_with_raised_eyebrow":"1f928.png","face_with_rolling_eyes":"1f644.png","face_with_symbols_on_mouth":"1f92c.png","face_with_thermometer":"1f912.png","fearful":"1f628.png","flushed":"1f633.png","frowning":"1f626.png","ghost":"1f47b.png","gift_heart":"1f49d.png","green_heart":"1f49a.png","grimacing":"1f62c.png","grin":"1f601.png","grinning":"1f600.png","hankey":"1f4a9.png","hear_no_evil":"1f649.png","heart":"2764-fe0f.png","heart_decoration":"1f49f.png","heart_eyes":"1f60d.png","heart_eyes_cat":"1f63b.png","heartbeat":"1f493.png","heartpulse":"1f497.png","heavy_heart_exclamation_mark_ornament":"2763-fe0f.png","hole":"1f573-fe0f.png","hot_face":"1f975.png","hugging_face":"1f917.png","hushed":"1f62f.png","imp":"1f47f.png","innocent":"1f607.png","japanese_goblin":"1f47a.png","japanese_ogre":"1f479.png","joy":"1f602.png","joy_cat":"1f639.png","kiss":"1f48b.png","kissing":"1f617.png","kissing_cat":"1f63d.png","kissing_closed_eyes":"1f61a.png","kissing_heart":"1f618.png","kissing_smiling_eyes":"1f619.png","laughing":"1f606.png","left_speech_bubble":"1f5e8-fe0f.png","love_letter":"1f48c.png","lying_face":"1f925.png","mask":"1f637.png","money_mouth_face":"1f911.png","nauseated_face":"1f922.png","nerd_face":"1f913.png","neutral_face":"1f610.png","no_mouth":"1f636.png","open_mouth":"1f62e.png","orange_heart":"1f9e1.png","partying_face":"1f973.png","pensive":"1f614.png","persevere":"1f623.png","pleading_face":"1f97a.png","pouting_cat":"1f63e.png","purple_heart":"1f49c.png","rage":"1f621.png","relaxed":"263a-fe0f.png","relieved":"1f60c.png","revolving_hearts":"1f49e.png","right_anger_bubble":"1f5ef-fe0f.png","robot_face":"1f916.png","rolling_on_the_floor_laughing":"1f923.png","scream":"1f631.png","scream_cat":"1f640.png","see_no_evil":"1f648.png","shushing_face":"1f92b.png","skull":"1f480.png","skull_and_crossbones":"2620-fe0f.png","sleeping":"1f634.png","sleepy":"1f62a.png","slightly_frowning_face":"1f641.png","slightly_smiling_face":"1f642.png","smile":"1f604.png","smile_cat":"1f638.png","smiley":"1f603.png","smiley_cat":"1f63a.png","smiling_face_with_3_hearts":"1f970.png","smiling_imp":"1f608.png","smirk":"1f60f.png","smirk_cat":"1f63c.png","sneezing_face":"1f927.png","sob":"1f62d.png","space_invader":"1f47e.png","sparkling_heart":"1f496.png","speak_no_evil":"1f64a.png","speech_balloon":"1f4ac.png","star-struck":"1f929.png","stuck_out_tongue":"1f61b.png","stuck_out_tongue_closed_eyes":"1f61d.png","stuck_out_tongue_winking_eye":"1f61c.png","sunglasses":"1f60e.png","sweat":"1f613.png","sweat_drops":"1f4a6.png","sweat_smile":"1f605.png","thinking_face":"1f914.png","thought_balloon":"1f4ad.png","tired_face":"1f62b.png","triumph":"1f624.png","two_hearts":"1f495.png","unamused":"1f612.png","upside_down_face":"1f643.png","weary":"1f629.png","white_frowning_face":"2639-fe0f.png","white_heart":"1f90d.png","wink":"1f609.png","woozy_face":"1f974.png","worried":"1f61f.png","yawning_face":"1f971.png","yellow_heart":"1f49b.png","yum":"1f60b.png","zany_face":"1f92a.png","zipper_mouth_face":"1f910.png","zzz":"1f4a4.png"},"enableQQ":false,"highlight":true,"lang":"zh-cn","pageSize":10,"placeholder":"你的评论 ...","recordIP":true,"serverURLs":"https://leancloud.hugoloveit.com","visitor":true}},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"sharerjs":true,"twemoji":true};</script><link rel="stylesheet" href="/lib/valine/valine.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery.js@1.2.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/copy-tex.min.css"></div>
</body>

</html>